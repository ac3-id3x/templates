$$B:ID3:LOOP:ALIAS:PRELOADFILE:;:cancel.gif;control_play_blue.gif;control_pause_blue.gif;page_white_edit.gif;valider.gif;folder.gif;tridesc.gif;triasc.gif;podiumAnim.gif;podium1.gif;podium2.gif;podium3.gif$$$$BIF:PRELOADFILE$$
MM_preloadImages($$DO$$'/z/portail/pol/engine/centredecontact/icons/$$PRELOADFILE:1$$'$$IF!:PRELOADFILE_I:PRELOADFILE:NBR$$,$$END$$$$LOOP$$);
$$BFIN$$

function loadRing(){
		var ringCP = document.getElementById('couronneCP').value;
		var ringRAY = document.getElementById('couronneRayon').value;
		if(parseInt(ringRAY)<=50){window.open(ringRAY+'/'+ringCP+'/$$REP:0 field 1$$,listecp.htm?','cpliste','width=300,height=450,scrollbars=yes');}
		else{document.getElementById('gestErrorCouronne').innerHTML = "Le rayon doit &ecirc;tre compris entre 1 et 50km"};
}

function Checknamecampagne()
{
	alert("ok");
	var oldname=MM_findObj("oldname");
	var nomcampagne=MM_findObj("nomcampagne");
	alert(nomcampagne.value);
	alert(oldname.value);
	if(nomcampagne.value == oldname.value) nomcampagne.value="";
	
}

function CheckValues()
{
	var montant=MM_findObj("montantAlertes");
	var etat=MM_findObj("etatalerte");	
	if(montant.value=='0' || montant.value=='') etat.value='w';
	else etat.value='a';
	//etatalerte -->simontantnull alors w sinon a
}

function gestForm(a,b,e){
	myArray = new Array; 
	myVars = new Array; 
	myArray = b.split(","); 
	for (i=0; i < myArray.length; i++)
	{
		myVars[myArray[i].substring(0,myArray[i].lastIndexOf("="))] = myArray[i].substring(myArray[i].lastIndexOf("=")+1,myArray[i].length); // ex myVars['iduser'] contient l'iduser
	}
	formSource = '';
	switch(a){
		case 'plafond':
			formSource = '';
			if(myVars['plafondmensuel'] <= myVars['plafondmax']){
			formSource += '<form id="formGestMandat" method="post"> \r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:editclient" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';		
			formSource += '<input type="hidden" name="idclient" value="'+myVars['idclient']+'" />\r\n';
			formSource += '<input type="hidden" name="plafondmensuel" value="'+myVars['plafondmensuel']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '</form>';
			}
			else displayError('Montant maximum autorisé : $$MANDATVENTE:CLIENT:PLAFONDMAX formatnumber 0$$ &euro;');
			break;
		case 'ajoutAlerte':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			formSource += '<h3>Ajouter une recherche</h3>';
			formSource += '<form id="formGestMandat" method="post">\r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:ajoutalerte" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';		
			formSource += '<input type="hidden" name="idcampagne" value="'+myVars['idcampagne']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			$$IF>:2,4:OBJECTIFMANDATS:VERSION$$<!-- preprod alerte witness -->
			formSource += 'Etat de la recherche : <input type="radio" name="etatalerte" value="a" checked id="alertea" onClick="activField(\'ajoutAlerte:montantalertes\',\'inline\');"/> <label for="alertea">Contact Chrono</label>\r\n';
			formSource += '<input type="radio" name="etatalerte" value="w" id="alertei" onClick="activField(\'ajoutAlerte:montantalertes\',\'none\');"/> <label for="alertei">Contact Gratuit</label> <br /> \r\n';
			$$END$$
			$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
			formSource += 'Etat de l\'alerte : <input type="radio" name="etatalerte" value="a" checked id="alertea" /> <label for="alertea">Active </label>\r\n';
			formSource += '<input type="radio" name="etatalerte" value="i" id="alertei" /> <label for="alertei">Inactive</label> <br /> \r\n';
			$$END$$
			formSource += 'Type de bien : <select name="idtypebien">$$BIF:BIENS$$$$DO$$<option value="$$BIENS:IDTYPEBIEN$$">$$BIENS:TYPEBIEN$$$$LOOP$$$$BFIN$$</select><br /> \r\n';
			formSource += 'Type de transaction : <select name="idtypetransac">$$BIF:TRANSACTIONS$$$$DO$$<option value="$$TRANSACTIONS:IDTYPETRANSAC$$">$$TRANSACTIONS:TYPETRANSACTION$$$$LOOP$$$$BFIN$$</select><br /> \r\n';
			$$IF>:2,4:OBJECTIFMANDATS:VERSION$$<!-- preprod alerte witness -->
			formSource += 'Montant de la recherche : <input type="text" name="montantalertes" id="ajoutAlerte:montantalertes" value="" /> &euro; *<br /> \r\n';
			$$END$$			
			$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
			formSource += 'Montant de l\'alerte : <input type="text" name="montantalertes" value="" /> &euro; *<br /> \r\n';
			$$END$$
			formSource += 'Code postal : <input type="text" name="cpAlerte" value="" size="5" /> * <br /> \r\n';
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />';
			formSource += '</form>';
			break;	
		case 'editalerte':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';			
			formSource += 'Etes-vous certain de vouloir supprimer cette alerte?<br /> \r\n';
			formSource += '<form id="formGestMandat" method="post">\r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:editalerte" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$" />\r\n';		
			formSource += '<input type="hidden" name="idalerte" value="'+myVars['idalerte']+'" />\r\n';
			$$REM:150106$$<!-- preprod prévoir alerte witness -->$$END$$
			formSource += '<input type="hidden" name="etatalerte" value="'+myVars['etatalerte']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />&nbsp;';	
			formSource += '<input type="button" value="Non" OnClick="javascript:display(\'divGestMandat\');" />';	
			formSource += '</form>';
			break;	
		case 'montantalerte':
				$$REM$$if(myVars['montantAlertes']=='0') {alert("Saisir un montant supérieur à 0 !");}$$END$$			
				formSource = '';
				formSource += '<form id="formGestMandat" method="post">\r\n';
				formSource += '<input type="hidden" name="u" value="mandatvente:editalerte" />\r\n';
				formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
				formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';		
				formSource += '<input type="hidden" name="idalerte" value="'+myVars['idalerte']+'" />\r\n';
				formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
				$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
				if (myVars['etatalerte']) {formSource += '<input type="hidden" name="etatalerte" value="'+myVars['etatalerte']+'" />\r\n';}
				formSource += '<input type="hidden" name="montantAlertes" value="'+myVars['montantAlertes']+'" />\r\n';			
				$$END$$
				$$IF>:2,4:OBJECTIFMANDATS:VERSION$$<!-- preprod -->
				if(myVars['montantAlertes']=='0' || myVars['montantAlertes']==''){
					formSource += '<input type="hidden" name="etatalerte" value="W" />\r\n';
					formSource += '<input type="hidden" name="montantAlertes" value="" />\r\n';						
				}
				else{
					formSource += '<input type="hidden" name="etatalerte"			value="A" />\r\n';
					formSource += '<input type="hidden" name="montantAlertes"	value="'+myVars['montantAlertes']+'" />\r\n';			
				}$$END$$
				formSource += '</form>';
			break;	
		case 'editAllAlerte':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			$$IF>:2,4:OBJECTIFMANDATS:VERSION$$<!-- preprod -->
			formSource += '<h3> Modifier toutes les recherches : </h3>';
			$$END$$
			$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
			formSource += '<h3> Modifier toutes les  alertes de mon groupe : </h3>';
			$$END$$			
			formSource += '<form id="formGestMandat" method="post">\r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:campagneeditalertes" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';		
			formSource += '<input type="hidden" name="idcampagne" value="'+myVars['idcampagne']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			$$REM:150106$$<!-- preprod prévoir alerte witness -->$$END$$
			$$IF>:2,4:OBJECTIFMANDATS:VERSION$$
				formSource += 'Etat des recherches : <input type="radio" name="etatalerte" value="a" checked id="alertea" onClick="activField(\'editAllAlerte:montantalerte\',\'inline\');" /> <label for="alertea">Contact Chrono</label>\r\n';
				formSource += '<input type="radio" name="etatalerte" value="w" id="alertei" onClick="activField(\'editAllAlerte:montantalerte\',\'none\');" /> <label for="alertei">Contact Gratuit</label> \r\n';
				formSource += '<input type="radio" name="etatalerte" value="s" id="alertes" onClick="activField(\'editAllAlerte:montantalerte\',\'none\');" /> <label for="alertes">Supprim&eacute;es</label> <br />\r\n';
				formSource += 'Montant des recherches : <input type="text" name="montantalerte" id="editAllAlerte:montantalerte" value="" /> &euro; *<br /> \r\n';
			$$END$$
			$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
				formSource += 'Etat des alertes : <input type="radio" name="etatalerte" value="a" checked id="alertea" /> <label for="alertea">Actives </label>\r\n';
				formSource += '<input type="radio" name="etatalerte" value="i" id="alertei" /> <label for="alertei">Inactives</label> \r\n';
				formSource += '<input type="radio" name="etatalerte" value="s" id="alertes" /> <label for="alertes">Supprim&eacute;es</label> <br />\r\n';
				formSource += 'Montant des alertes : <input type="text" name="montantalerte" value="" /> &euro; *<br /> \r\n';
			$$END$$			
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />';			
			formSource += '</form>';
			break;				
		case 'desactivcampagne':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';			
			formSource += 'Etes-vous certain de vouloir supprimer cette campagne?<br /> \r\n';			
			formSource += '<form id="formGestMandat" method="post">\r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:editcampagne" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';			
			formSource += '<input type="hidden" name="idcampagne" value="'+myVars['idcampagne']+'" />\r\n';
			formSource += '<input type="hidden" name="etatcampagne" value="'+myVars['etatcampagne']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />&nbsp;';	
			formSource += '<input type="button" value="Non" OnClick="javascript:display(\'divGestMandat\');" />';				
			formSource += '</form>';
			break;	
		case 'premiereAlerte':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			formSource += '<form id="formGestMandat" method="post"> \r\n';
			formSource += '<b>Créer une nouvelle alerte</b>';
			formSource += '<br />Pour cibler les biens désirés, précisez les critères suivants :';
			formSource += '<input type="hidden" name="form-a" value="'+a+'" />\r\n';			
			formSource += '<input type="hidden" name="form-b" value="'+b+'" />\r\n';			
			formSource += '<input type="hidden" name="u" value="mandatvente:campagnemultiple" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';			
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '<input type="hidden" name="etatcampagne" value="a" />\r\n';
			formSource += '<input type="hidden" name="idclient" value="'+myVars['idclient']+'" />\r\n';
			formSource += '<hr /> \r\n';
			formSource += '<b> Votre recherche </b> <hr />';
			formSource += 'Des biens en $$BIF:TRANSACTIONS$$$$DO$$<input type="checkbox" name="listetypetransac" id="listetypetransac$$TRANSACTIONS:IDTYPETRANSAC$$" value="$$TRANSACTIONS:IDTYPETRANSAC$$"><label for="listetypetransac$$TRANSACTIONS:IDTYPETRANSAC$$">$$TRANSACTIONS:TYPETRANSACTION$$</label>$$LOOP$$$$BFIN$$ &nbsp;  *<br />';
			formSource += 'Et de type $$BIF:BIENS$$$$DO$$<input type="checkbox" name="listetypebien" id="listetypebien$$BIENS:IDTYPEBIEN$$" value="$$BIENS:IDTYPEBIEN$$"><label for="listetypebien$$BIENS:IDTYPEBIEN$$">$$BIENS:TYPEBIEN$$</label>$$LOOP$$$$BFIN$$ &nbsp;  *<br /> \r\n';
			formSource += 'Code Postal des biens recherchés * : '; 
			for (i=0; i<myVars['cp']; i++){
				if(i==0){formSource += '<span id="listCp"><input type="text" name="LISTECP" id="LISTECP'+i+'" value="$$SLPRO:INFOSAGENCE:CP$$" size="5" /></span> ';} 
				else{formSource += '<span id="listCp"><input type="text" name="LISTECP" id="LISTECP'+i+'" value="" size="5" /></span> ';} 	
					
			}
			formSource += '<span class="greyinfo">ex: $$SLPRO:INFOSAGENCE:CP$$</span>';	
			formSource += '<br /><br />';
			formSource += '<b>Recherche par proximité</b>';
			formSource += '<div id="listeCpProximite">';
			formSource += '<div id="gestErrorCouronne" style="font-weight:bold; color:#d4000e; padding:5px;"></div>';
			
			formSource += 'Afficher les villes dans un rayon de : <input type="text" id="couronneRayon" value="" size="5" maxlength="2"  />km &nbsp; <span style="color:grey; font-size:10px;">(max : 50 km)</span><br /> ';
			formSource += 'Autour du Code Postal :<input type="text" id="couronneCP" value="" size="5" maxlength="5"  /> &nbsp; ';
			formSource += '<input type="button" value="OK" onClick="loadRing();"/>';
			
			formSource += '</div>';
			formSource += '<br /><hr />';
			formSource += '<b> Votre alerte </b><hr />';
			formSource += 'Montant de l\'enchère : <input type="text" name="montantalertes" size="3" value="" /> &euro; *<br /> \r\n';
			formSource += 'Email utilisé pour le suivi de l\'alerte : <input type="text" name="emailcampagne" value="$$MANDATVENTE:CLIENT:EMAILCLIENT$$" />*<br />\r\n';
			formSource += 'Nom du nouveau groupe associé : <input type="text" name="nomcampagne" value="groupe$$MANDATVENTE:CLIENT:TOT_CAMPAGNE_ALL exec XX+1$$" /> *<br /> \r\n';				
			formSource += 'Vous souhaitez créer des alertes <input type="radio" name="etatalerte" value="a" checked />actives <input type="radio" name="etatalerte" value="i" />inactives <br />';
			formSource += '<br /> \r\n';
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />';			
			formSource += '</form>';
			formSource += '* champs obligatoire';
			break;		
		case 'ajoutcampagne':
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			if(myVars['cp']){
			formSource += '<h3>Ajouter un groupe</h3>';
			}
			else{
			formSource += '<h3>Alertes et groupe en un seul clic!</h3>';
			}
			formSource += '<form id="formGestMandat" method="post"> <br />\r\n';
			if(myVars['cp']){formSource += '<input type="hidden" name="u" value="mandatvente:campagnemultiple" />\r\n';}
			else {formSource += '<input type="hidden" name="u" value="mandatvente:saisiecampagne" />\r\n';}
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';			
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '<input type="hidden" name="idclient" value="'+myVars['idclient']+'" />\r\n';
			formSource += 'Nom du groupe : <input type="text" name="nomcampagne" value="Campagne$$MANDATVENTE:CLIENT:TOT_CAMPAGNE_ALL exec XX+1$$" /> *<br /> \r\n';
			formSource += 'Email associ&eacute; : <input type="text" name="emailcampagne" value="$$MANDATVENTE:CLIENT:EMAILCLIENT$$" /><br />\r\n';
			if(myVars['cp']){
				formSource += 'Type de bien : <select name="listetypebien">$$BIF:BIENS$$$$DO$$<option value="$$BIENS:IDTYPEBIEN$$">$$BIENS:TYPEBIEN$$$$LOOP$$$$BFIN$$</select><br /> \r\n';
				formSource += 'Type de transaction : <select name="listetypetransac">$$BIF:TRANSACTIONS$$$$DO$$<option value="$$TRANSACTIONS:IDTYPETRANSAC$$">$$TRANSACTIONS:TYPETRANSACTION$$$$LOOP$$$$BFIN$$</select><br /> \r\n';
				
				formSource += 'Montant de l\'alerte : <input type="text" name="montantalertes" value="" /> &euro; *<br /> \r\n';
				
				formSource += 'CP :'; 
				for (i=0; i<myVars['cp']; i++){
					formSource += '<input type="text" name="LISTECP" value="" size="5" /> '; 
				}	
				formSource += '* <br /> \r\n';
			}		
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />';
			formSource += '</form>';
			formSource += '* champs obligatoire';
			break;				
		case 'editcampagne':			
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			formSource += '<h3>Modifier une campagne</h3>';
			formSource += '<form id="formGestMandat" method="post" >\r\n';
			formSource += '<input type="hidden" name="u" value="mandatvente:editcampagne" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';						
			formSource += '<input type="hidden" name="idcampagne" value="'+myVars['idcampagne']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += 'Nom : <input type="text" name="nomcampagne" value="'+myVars['nomcampagne'].replace('§',',')+'" size="20" /> *<br /> \r\n';
			formSource += 'Email associ&eacute; : <input type="text" name="emailcampagne" value="'+myVars['emailcampagne']+'" size="40" /><br />\r\n';
			formSource += 'Etat : \r\n'
			if(myVars['etatcampagne']=='A' || myVars['etatcampagne']=='a') 
				formSource += '<label for="alertea"><input type="radio" name="etatcampagne" value="a" checked id="alertea" />Active </label>\r\n';
			else
				formSource += '<label for="alertea"><input type="radio" name="etatcampagne" value="a" id="alertea" />Active </label>\r\n';
			if(myVars['etatcampagne']=='I' || myVars['etatcampagne']=='i') 
				formSource += '<label for="alertei"><input type="radio" name="etatcampagne" value="i" checked id="alertei" />Inactive </label>\r\n';
			else
				formSource += '<label for="alertei"><input type="radio" name="etatcampagne" value="i" id="alertei" />Inactive </label>\r\n';
			if(myVars['etatcampagne']=='S' || myVars['etatcampagne']=='s') 
				formSource += '<label for="alertes"><input type="radio" name="etatcampagne" value="s" checked id="alertes"  />Supprim&eacute;e </label>\r\n';
			else
				formSource += '<label for="alertes"><input type="radio" name="etatcampagne" value="s" id="alertes" />Supprim&eacute;e </label>\r\n';								

			formSource += '<br /><input type="submit" value="'+myVars['submitButton']+'" />';	
			$$IF:MODEDEV$$ formSource += '<img src="$$_$$i/dyn/btnvalider.png">';$$END$$		
			formSource += '</form>';
			break;			
		case 'modifalerte':		
			formSource = '';
			formSource += '<span style="float:right"><a href="javascript:display(\'divGestMandat\');" class="decorationone">[x]</a></span>';
			formSource += '<h3>Modifier le prix</h3>';
			formSource += '<form id="formGestMandat" method="post" onSubmit="return CheckValues();">\r\n';			
			formSource += 'Recherche de '+myVars['tt']+'\r\n';
			formSource += 'pour le code postal: '+myVars['cp']+'\r\n<br><br>';
			formSource += 'Indiquez le montant maximum que vous souhaitez payer pour acquérir un contact correspondant à votre recherche :\r\n<br>'
			formSource += '<input type="hidden" name="u" value="mandatvente:editalerte" />\r\n';
			formSource += '<input type="hidden" name="page_ok" value="/$$REP:URI$$" />\r\n';
			formSource += '<input type="hidden" name="page_err" value="/$$REP:URI$$"/>\r\n';		
			formSource += '<input type="hidden" name="idalerte" value="'+myVars['idalerte']+'" />\r\n';
			formSource += '<input type="hidden" name="iduser" value="'+myVars['iduser']+'" />\r\n';
			formSource += '<input type="hidden" name="etatalerte"	value="A" />\r\n';
			formSource += 'Montant:&nbsp; <input type="text" name="montantAlertes"	value="'+myVars['montantAlertes']+'" size="4" />€ *\r\n';					
			formSource += '<br>*Montant minimum : 10 € \r\n<br>';
			$$REM$$<!--
				$$IF<:2,4:OBJECTIFMANDATS:VERSION$$
				if (myVars['etatalerte']) {formSource += '<input type="hidden" name="etatalerte" value="'+myVars['etatalerte']+'" />\r\n';}
				formSource += '<input type="text" name="montantAlertes" value="'+myVars['montantAlertes']+'" size="4" />\r\n';			
				$$END$$
				$$IF>:2,4:OBJECTIFMANDATS:VERSION$$
				if(myVars['montantAlertes']=='0' || myVars['montantAlertes']==''){
					formSource += '<input type="hidden" name="etatalerte" value="W" />\r\n';
					formSource += '<input type="text" name="montantAlertes" value="" size="4" />\r\n';						
				}
				else{
					formSource += '<input type="hidden" name="etatalerte"			value="A" />\r\n';
					formSource += 'prix=<input type="text" name="montantAlertes"	value="'+myVars['montantAlertes']+'" size="4" />\r\n';			
				}$$END$$
			-->$$END$$
			formSource += '<input type="submit" value="'+myVars['submitButton']+'" />';				
			formSource += '</form>';
			break;							
		default:
			 err = 'Aucune action sp&eacute;cif&eacute;e';
			break;
	}	 
	if(formSource){
		document.getElementById('divGestMandat').innerHTML = formSource;
		if(myVars['submitButton'] == '' || myVars['submitButton'] == undefined) {
			if(document.getElementById('formGestMandat').action == undefined || document.getElementById('formGestMandat').action == '')document.getElementById('formGestMandat').action = '/$$REP:URI$$?display=$$FORM:DISPLAY$$';
			document.getElementById('formGestMandat').submit();
		}
		else {
			var posx = 0;
			var posy = 0;
			if (!e) {e = window.event;}
			if (e.pageX || e.pageY)
			{
				posx = e.pageX;
				posy = e.pageY;
			}
			else if (e.clientX || e.clientY)
			{
				if(document.documentElement.scrollTop){
					posx = e.clientX + document.documentElement.scrollLeft;
					posy = e.clientY + document.documentElement.scrollTop;				
				}
				else{
				posx = e.clientX + document.body.scrollLeft;
				posy = e.clientY + document.body.scrollTop;
				}
			}
			//document.getElementById('divGestMandat').style.left = posx+10;
			document.getElementById('divGestMandat').style.top = posy+ "px";
			$$REM$$<!--
				posInfo = "";
				posInfo += "clientX : "+e.clientX+" | clientY : "+e.clientY +"<br />";
				posInfo += "layerX : "+e.layerX+" | layerY : "+e.layerY +"<br />";
				posInfo += "offsetX : "+e.offsetX+" | offsetY : "+e.offsetY +"<br />";
				posInfo += "pageX : "+e.pageX+" | pageY : "+e.pageY +"<br />";
				posInfo += "screenX : "+e.screenX+" | screenY : "+e.screenY +"<br />";
				posInfo += "X : "+e.x+" | Y : "+e.y +"<br />";
				posInfo += "posX : "+posx+" | posy : "+posy+"<br />";	
				posInfo += "divGestMandat.Left : "+document.getElementById('divGestMandat').style.left+" | divGestMandat.Top : "+document.getElementById('divGestMandat').style.top+"<br />";	
				posInfo += "Browser : "+navigator.userAgent+"<br />";	
				document.getElementById('gestError').innerHTML = posInfo;
			-->$$END$$
			document.getElementById('divGestMandat').style.display = 'inline';		
			document.getElementById('divGestMandat').style.visibility = 'visible';
		}
	}
	else document.getElementById('divGestMandat').innerHTML = err;
}
function displayError(a,b){
content = document.getElementById('gestError').innerHTML;
	if(content.indexOf(a) == -1){
		if(document.getElementById('gestError').innerHTML ==''){
			document.getElementById('gestError').innerHTML = '<img src="$$_$$engine/centredecontact/icons/error.gif" style="margin-right:5px;" />';
			document.getElementById('gestError').className =(b==1)? 'gestOk' : 'gestError';
		}
		document.getElementById('gestError').innerHTML += "\r\n" +a;
	}
}
function triAlerte(tri,ordre,typerec,type){
	var triUrl = "$$REP:0$$?";
	if(typerec){triUrl += "&typerec="+typerec;}
	if(type){triUrl += "&type="+type;}

	switch(tri){
		case 'campagne': 
			url =triUrl+((ordre == "desc")?"&tri=!NTBC":"&tri=NTBC");
			break;		
		case 'transaction':
			url=triUrl+((ordre == "desc")?"&tri=!TNBC":"&tri=TNBC");
			break;						
		case 'cp':
			url=triUrl+((ordre == "desc")?"&tri=!CTBN":"&tri=CTBN");
			break;						
		case 'bien':
			url=triUrl+((ordre == "desc")?"&tri=!BTCN":"&tri=BTCN");
			break;						
		case 'montant':
			url=triUrl+((ordre == "desc")?"&tri=!PTBCN":"&tri=PTBCN");
			break;						

	}
	window.location = url;
}

$$A:ERRECODE=@@MANDATVENTE:EDITCLIENT:ERRECODE@@@@MANDATVENTE:CAMPAGNEMULTIPLE:ERRECODE@@@@MANDATVENTE:EDITCAMPAGNE:ERRECODE@@@@MANDATVENTE:EDITALERTE:ERRECODE@@@@MANDATVENTE:AJOUTALERTE:ERRECODE@@@@MANDATVENTE:CAMPAGNEEDITALERTES:ERRECODE@@@@MANDATVENTE:UPDATECLIENT_PRESSIMMO:ERRECODE@@$$

$$IF=:DUP_NOM_CAMPAGNE:ERRECODE$$
	$$A:ERRECODE:FOUND=1$$
	displayError('Ce nom de campagne existe déjà $$IF:FORM:FORM-A$$ <a href="javascript:gestForm(\'$$FORM:FORM-A$$\',\'$$FORM:FORM-B$$\',event);">Réafficher le formulaire </a>$$END$$');
$$END$$

$$IF=:MONTANT_TROP_BAS:ERRECODE$$
	$$A:ERRECODE:FOUND=1$$
	displayError('Le montant est inférieur au montant minimum $$IF:FORM:FORM-A$$ <a href="javascript:gestForm(\'$$FORM:FORM-A$$\',\'$$FORM:FORM-B$$\',event);">Réafficher le formulaire </a>$$END$$');
$$END$$

$$IF=:DUP_NOM_ALERTE:ERRECODE$$
	$$A:ERRECODE:FOUND=1$$
	displayError('Ce type d\'alerte existe déjà $$IF:FORM:FORM-A$$ <a href="javascript:gestForm(\'$$FORM:FORM-A$$\',\'$$FORM:FORM-B$$\',event);">Réafficher le formulaire </a>$$END$$');
$$END$$

$$IF=:PLAFOND_TROP_HAUT:ERRECODE$$
	$$A:ERRECODE:FOUND=1$$
	displayError('Le plafond donné dépasse votre plafond maximum $$IF:FORM:FORM-A$$ <a href="javascript:gestForm(\'$$FORM:FORM-A$$\',\'$$FORM:FORM-B$$\',event);">Réafficher le formulaire </a>$$END$$');
$$END$$

$$IF0:ERRECODE:FOUND$$
	$$IF:ERRE$$
		displayError('$$ERRE escape$$ $$IF:FORM:FORM-A$$ <a href="javascript:gestForm(\'$$FORM:FORM-A$$\',\'$$FORM:FORM-B$$\',event);">Réafficher le formulaire </a>$$END$$');
	$$END$$
$$END$$


$$A:OK=@@MANDATVENTE:SAISIEMANDAT:OK@@@@MANDATVENTE:VALIDEMULTIPLEMANDAT:OK@@@@MANDATVENTE:EDITCLIENT:OK@@@@MANDATVENTE:CAMPAGNEMULTIPLE:OK@@@@MANDATVENTE:EDITCAMPAGNE:OK@@@@MANDATVENTE:MULTIEDITALERTE:OK@@@@MANDATVENTE:EDITALERTE:OK@@@@MANDATVENTE:AJOUTALERTE:OK@@@@MANDATVENTE:CAMPAGNEEDITALERTES:OK@@$$
$$IF:OK$$
	displayError('$$OK escape$$',1);
$$END$$

$$IF>:2,4:OBJECTIFMANDATS:VERSION$$
function smartSearchDisplay(a){
	myDiv = document.getElementById("groupealerte"+a);
	if (myDiv && myDiv.style.display){
		if(myDiv.style.display == 'none'){
			myDiv.style.display = 'inline';
			document.getElementById("btnSearchDisplay"+a).innerHTML = "Masquer les recherches";	
		}
		else{
			myDiv.style.display = "none";
			document.getElementById("btnSearchDisplay"+a).innerHTML = "Afficher les recherches";
		}
	}
}
$$END$$

/* input disabled aspect when necessary, ex : amount input */
function activField(a,b){
	if(b ==  'inline'){
	document.getElementById(a).disabled = false;
	document.getElementById(a).style.backgroundColor = '#fff';
	}
	else{
	document.getElementById(a).disabled = true;
	document.getElementById(a).value = '';
	document.getElementById(a).style.backgroundColor = '#ccc';
	}
}

function display(a){
	if (document.getElementById(a).style.visibility){
		if (document.getElementById(a).style.visibility == 'visible'){
			document.getElementById(a).innerHTML = '';
			document.getElementById(a).style.visibility = 'hidden';
		}
		else {document.getElementById(a).style.visibility = 'visible';}
	}
}
function keyControl(e,a){
 if(e.keyCode == 13){
 	eval(unescape(a));
 }
}
