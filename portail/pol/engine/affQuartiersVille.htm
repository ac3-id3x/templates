$$DYN:ID3:NOCACHE:FULL$$
$$A:GMKEY=ABQIAAAAxGi6UAETf3q68PMcXqKFXhQV3BEbCAyAHd3qENbYhD7z5MCJEBTU2jTDVstunHtTYeY31cgE5SZJSw$$
$$IF:XDEV$$
$$Ab:GMKEY=ABQIAAAAxGi6UAETf3q68PMcXqKFXhR2JiSPLUESL7mO862X3PySvBVExRTLHwSlkZlhGhJ_qexbF19JuaC1UA$$
$$END$$
$$IF:FORM:CI$$
<html xmlns:v="urn:schemas-microsoft-com:vml" ><head>$$IF0:TITLE$$<TITLE>SeLogerPro</TITLE>$$END$$

<meta http-equiv="content-type" content="text/html; charset=utf-8"/>

<META NAME="MSSmartTagsPreventParsing" content="TRUE">
<script type="text/javascript" language="javascript" SRC="$$_$$sl.js"></SCRIPT>
<link rel="stylesheet" type="text/css" href="$$_$$st1.css" media="all">
<link rel="stylesheet" type="text/css" href="$$_$$annonce.css" media="all">
<style>

*#footer .footerg a {
	text-decoration:none;
	color:#FFFFFF;
	cursor:default;
}

*#footerpetit .footerg a {
	text-decoration:none;
	color:#FFFFFF;
	cursor:default;
}

*#tout {
margin-top:4px;
border:0px solid black;
width: auto;
/*background-color:#E6E6D8;*/
background-color:none;
}

dt {padding-top:5px;}

*#menu {top:5px;}

#mapcontainer {
border:1px solid #aaa;
background-color:#fff;
padding:4px;
margin: 4px 2px 2px 2px;
}
#map {
border:1px solid #aaa;
min-height:380px;
}

#quartieraff {
border:1px solid #aaa;
background-color:#fff;
padding:4px;
margin: 4px 2px 2px 2px;
}

#villespro {
	width:500px;
	text-align:left;
}

#quartiersearch {
color:black;
margin-top:5px;
}

</style>
 <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=$$GMKEY$$&hl=fr"
      type="text/javascript"></script>
</head>
<body onload="initMap()" onunload="GUnload()"  scroll=no bgcolor="#FFFFFF" leftmargin="0" topmargin="0"  LINK="#000000" ALINK="#000000" VLINK="#000000" TEXT="#000000">
<center>
	
<div id=mapcontainer>
	
	<div id="map" style="width: 95%; height: 95%"></div>
	<script type="text/javascript" src="$$-$$js/pdmarker.js"></script>
	<script>
		
	var libelle;
	var libellex;
	var libelley;
	var pointLibelle;
	var pointsQuartier = [];
		// Polygone courant
	var currentPoly = new Array();
	var currentBounds = "";
		// Liste des quartiers: quartier = [libelle, poly, pointCentre] par rapport ?n id
  var quartiers = new Array();  

    
	var centrer = new GLatLngBounds;
	var pointtmp;

	// Affichage des quartiers.
	var lbounds;
	function getQuartiers(idquartier, limites, xlib, ylib,lib) {		
		lbounds = new Array();						
		pointsQuartier = new Array();		
		
		lbounds = limites.split(',');					
    for (var i = 0; i < lbounds.length; i+=2) {  
    	pointtmp = new GLatLng(lbounds[i],lbounds[i+1]);
      pointsQuartier.push(pointtmp);
      centrer.extend(pointtmp);
   	}
   	//pointsQuartier.push(new GMarker(new GLatLng(lbounds[1],lbounds[0])));   
   	quartiers.push(idquartier) 
   	quartiers.push(new GLatLng(xlib,ylib));
   	quartiers.push(lib);   	       	
   	quartiers.push(pointsQuartier);     	   	 	
	}
	
	$$B:E3:GETQUARTIERBOUNDSLL:QRY:CI:ALIAS:QUARTIERS$$
	$$BIF:QUARTIERS$$
		$$DO$$						
			getQuartiers($$QUARTIERS:IDQUARTIER$$, '$$QUARTIERS:LIMITES$$',$$QUARTIERS:XLIBELLE replace , . $$,$$QUARTIERS:YLIBELLE replace , . $$,'$$QUARTIERS:LIBELLE escape$$');   						
		$$LOOP$$
	$$BFIN$$	
	

 	function initMap() {
	  if (GBrowserIsCompatible()) {      	
	  			// Declaration des variables
	  	var flagMove = false;
			var idQuartier = 0;
			
	  	var currentPoint;
	  	var currentMarker;      	
	      	
	  	// Liste de tous les points de la carte
	  	var points  = [];
	  	var flagMarker = false;
	  	var newQuartier = false;
	  	var icon = new GIcon();
			icon.image = "http://labs.google.com/ridefinder/images/mm_20_black.png";
			icon.shadow = "http://labs.google.com/ridefinder/images/mm_20_shadow.png";
			icon.iconSize = new GSize(12, 20);
			icon.shadowSize = new GSize(22, 20);
			icon.iconAnchor = new GPoint(6, 20);
			icon.infoWindowAnchor = new GPoint(5, 1);
	
	  	
	  	
	    var map = new GMap2(document.getElementById("map"));
	    map.addControl(new GLargeMapControl());
	    map.addControl(new GMapTypeControl());
			map.addControl(new GOverviewMapControl());
			map.setCenter(centrer.getCenter(), map.getBoundsZoomLevel(centrer));				
			var affPoly;	
			// On affiche les quartiers existants pour utilisation des marqueurs:				
			for(var s=0; s<quartiers.length; s+=4)
			{									
				affPoly = new Array();									
				//pointLibelle= new GMarker(quartiers[s+1],{icon:icon,title:quartiers[s+2]})		
				pointLibelle= new PdMarker(quartiers[s+1],{icon:icon,title:quartiers[s+2]});				
				//pointLibelle.setTooltip("<div id=quartieraff>"+quartiers[s+2]+"</div>");				
				map.addOverlay(pointLibelle);
				pointsQuartier = quartiers[s+3];
				for(var k=0; k < pointsQuartier.length ;k++)
				{								
					var pointBound = pointsQuartier[k];		
					affPoly.push(pointBound);							
				}													
				map.addOverlay(new GPolyline(affPoly,"",3,1));					
			}		
				  																																				    										
				window.focus();
		}
	}
  </Script>
 
 </div>
</body>
</html>
$$END$$
$$IF0:FORM:CI$$
	Impossible d'afficher des quartiers!
	Veuillez revenir vers votre annonce.
$$END$$