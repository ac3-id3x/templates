$$INCL:AUTH.HTM$$
$$DYN:ID3:NOCACHE$$
$$A:CAT=annonce_add_choix$$
$$INCL:HAUTX.HTM$$ 

<!-- $$REP:SRV$$ //-->

<script type="text/javascript">
<!--
	
	function skipmsg(namecookie){
		EcrireCookie("skipmsg"+namecookie,"1");
		var info_agorabiz = document.getElementById('info_agorabiz');
		info_agorabiz.style.display = 'none';	
	}

	function geschoixedit(v) {
		var objidtt = document.getElementById("idtypetransaction");
		var objidtb = document.getElementById("idtypebien");
		var temptype = document.getElementById("temptype");
		var btnvalider_choix = document.getElementById("btnvalider_choix");
		var info_agorabiz = document.getElementById('info_agorabiz');
		if(btnvalider_choix) btnvalider_choix.style.display = 'inline';
		if(info_agorabiz) info_agorabiz.style.display = 'none';
		if(objidtb) {objidtb.disabled = '';}
		if((v == 9)||(v == 10)){
			temptype.name = "idtypebienfc"; // Pour les ventes neuf et fond de commerce
			objidtb.disabled = 'disabled';
			if(v == 9){
				r = 15; 
				temptype.value = "15";
			}
		
			if(v == 10){
				r = 6; 
				temptype.value = "6";
				//	btnvalider_choix.style.display = 'none';
					info_agorabiz.style.display = 'block';
					initSize();
			}
		
			if(objidtb){
				for(i=0; i<objidtb.length; i++) {
					if (objidtb.options[i].value == r) {
						objidtb.selectedIndex = i;
						break;
					}
				}
			}
		}else{
			for(var i = 0 ,l = objidtb.options.length; i< l;i++ ){
				if(v == "11") {
					//btnvalider_choix.style.display = 'none';
					info_agorabiz.style.display = 'block';
					initSize();
					//objidtb.disabled = 'disabled';
					if(objidtb.options[i].value != "" && objidtb.options[i].value != "6" && objidtb.options[i].value != "7" && objidtb.options[i].value != "8")
					{
							if(objidtb.selectedIndex == i)
								objidtb.options[i].selected = false;
							objidtb.options[i].disabled="disabled";
					}
					else
						objidtb.options[i].removeAttribute("disabled");
				}
				else if(v == "3" || v == "4" || v == "5" || v == "6" || v == "8") {
					//btnvalider_choix.style.display = 'none';
					info_agorabiz.style.display = 'block';
					initSize();
					//objidtb.disabled = 'disabled';
					if(objidtb.options[i].value == "6" || objidtb.options[i].value == "7" || objidtb.options[i].value == "8")
					{
							if(objidtb.selectedIndex == i)
								objidtb.options[i].selected = false;
							objidtb.options[i].disabled="disabled";
					}
					else
						objidtb.options[i].removeAttribute("disabled");
				}
				else
					objidtb.options[i].removeAttribute("disabled");
					
				if ((objidtb.options[i].value == "15") 
						<!-- ||(v == "3" && objidtb.options[i].value == "12") -->
					)
				{
					if(objidtb.selectedIndex == i)
						objidtb.options[i].selected = false;
					objidtb.options[i].disabled="disabled";
				}	
			}
			if(temptype) {temptype.name= "temptype";}
		}
	}

function initchoixann(){
	var objidtt = document.getElementById("idtypetransaction");
	if(objidtt){objidtt.selectedIndex = 0;}
	var objidtb = document.getElementById("idtypebien");
	if(objidtb){
		objidtb.selectedIndex = 0;
		objidtb.disabled = '';
	}
}

function CheckTbTt() {
	var objtt=MM_findObj("idtypetransaction");
	var objtb=MM_findObj("idtypebien");
	var objForm = MM_findObj("newann");
	var errmsg = "";
	if (objtt.value == "") {errmsg = "vous devez sélectionner le type de transaction\n";}
	if (objtb.value == "") {errmsg += "vous devez sélectionner le type de bien\n";}
	
	if (errmsg == "")
	{
		if ((objtt.value == "11") 
			&& objtb.value != "6" && objtb.value != "7" && objtb.value != "8")
			{
				errmsg = "Vous devez choisir pour ce type de transaction un des biens suivants : boutique, bureau ou local.\n";
			}
		else  if ((objtt.value == "3" || objtt.value == "4" || objtt.value == "5" || objtt.value == "6" || objtt.value == "8") 
			&& (objtb.value == "6" || objtb.value == "7" || objtb.value == "8"))
		
		{	
			errmsg = "Vous ne pouvez pas choisir ce type de transaction pour ce bien\n";
		}
		else  if (objtt.value == "9" && objtb.value != "15" )
		{	
			errmsg = "Quand la transaction est une 'vente neuf' le type de bien doit etre un 'programme'\n";
		}
		else  if (objtt.value == "10" && objtb.value != "6" )
		{	
			errmsg = "Seul le type de bien 'boutique' est autorisé pour le type de transaction 'fond de commerce'.\n";
		}
		
	}

	if (errmsg != "") {
		alert("Pour pouvoir créer une annonce\n" + errmsg);
		return false;
	}else {
		return true;
	}
}	
	
function restictbcom(v){
		var btnvalider_choix = document.getElementById("btnvalider_choix");
		var info_agorabiz = document.getElementById('info_agorabiz');
		if(btnvalider_choix) btnvalider_choix.style.display = 'inline';
		if(info_agorabiz) info_agorabiz.style.display = 'none';
		if((v == 6)||(v == 7)||(v == 8)||(v == 11)||(v == 12)){
			//btnvalider_choix.style.display = 'none';
			info_agorabiz.style.display = 'block';	
			initSize();	
		}
}	
	
		$j(document).ready(function() {
			initchoixann;
		});		
	
	
	
	
	
//-->
</script>


$$B:SLPRO:TYPESTRANSACTION:ALIAS:TT$$	
$$B:SLPRO:TYPESBIEN:ALIAS:TB$$

$$E:IMMOBC:TESTWAG:VAL:AUTH_CHECK*LOGIN_IDAGENCE$$ <!-- util incl_hgestan.htm -->
$$E:SLPRO:TESTSLNEUF:VAL:AUTH_CHECK*LOGIN_IDAGENCE$$ 

<table class="tabbasic" cellpadding="0" cellspacing="0">
<tr><td class="tabentete">Type d'annonce à créer</td></tr>
<tr>
	<td>
	<form  method="get" name="newann" id="newann" action="/new/annonce_add.htm" onsubmit="return CheckTbTt();">
			
			$$E:SLPRO:FOND_COMMERCE_AUTORISE:ALIAS:FCA$$	
			$$BIF:TT$$	
			<select name="idtypetransaction" id="idtypetransaction" onchange="geschoixedit(this.options[this.selectedIndex].value);">
			<option value="">Type de transaction</option>
			$$DO$$	$$A:PGAFFICHTT=0$$	
							
				$$IF!:7:TT:IDTYPETRANSACTION$$
					$$IF:IMMOBC:TESTWAG:SI_WAG$$ $$A:PGAFFICHTT=1$$ $$END:SI_WAG$$
		
					$$IF0:IMMOBC:TESTWAG:SI_WAG$$
						$$IF!:9:TT:IDTYPETRANSACTION$$ $$A:PGAFFICHTT=1$$ $$END:IDTYPETRANSACTION$$
					$$END:SI_WAG$$
				
					$$IF=:10$11:TT:IDTYPETRANSACTION$$
						$$IF:WITH_COMMERCES$$ $$A:PGAFFICHTT=1$$ $$END:WITH_COMMERCES$$
					$$END$$
					
						$$IF=:1:SLPRO:TESTSLNEUF:SI_SLNEUF$$
							$$IF=:9:SLPRO:TYPESTRANSACTION:IDTYPETRANSACTION$$ $$A:PGAFFICHTT=0$$ $$END:IDTYPETRANSACTION$$
					 $$END:SI_SLNEUF$$
				$$END$$

                $$IF=:10:TT:IDTYPETRANSACTION$$
                    $$IF:0:FCA:AUTORISE$$
                        $$A:PGAFFICHTT=0$$
                    $$END$$
                $$END$$
				
				$$IF!:12:TT:IDTYPETRANSACTION$$
					$$IF=:1:PGAFFICHTT$$
							<option value="$$TT:IDTYPETRANSACTION$$"$$IF(:FORM_IDTYPETRANSACTION:TT:IDTYPETRANSACTION$$ SELECTED$$END$$>$$TT:TYPETRANSACTION replace vente¤fonds¤de¤commerce fonds¤de¤commerce replace vente¤de¤prestige prestige replace location¤vacances loc.¤vacances replace ¤ &nbsp; replace produit&nbsp;d'investissement investissement$$<br>				
					$$END$$
				$$END$$
				
			$$LOOP$$		
			</select>
			$$BFIN$$
				
			$$BIF:TB$$	
			<select name="idtypebien" id="idtypebien" >	
			<option value="">Type de bien</option>			
			$$DO$$
				$$IF!:16:TB:IDTYPEBIEN$$
					<option value="$$TB:IDTYPEBIEN mcase$$" $$IF(:FORM_IDTYPEBIEN:TB:IDTYPEBIEN$$ SELECTED$$END$$>$$TB:DESCRIPTION$$<br>	
				$$END$$
			$$LOOP$$ 
			</select>			
			$$BFIN$$ 			
		
			<input type="hidden" name="temptype" id="temptype" value="1" />
		&nbsp;
			<input type="image" src="$$_$$i/dyn/btnvalider.png" id="btnvalider_choix" />
			
			</form>
		</tr>
	</td>
</table>

$$A:VALSKIPBXAB=_editann$$
<div style="display: none;" id="info_agorabiz">
	<div id="info_agorabiz_cookie">
		$$INCL:BX_AB.HTM$$
	</div>
</div>

<script type="text/javascript">
<!--
	var skipmsg_editann = LireCookie("skipmsg_editann");	
	var info_agorabiz_cookie = document.getElementById('info_agorabiz_cookie');
	if(skipmsg_editann == "1"){
		if(info_agorabiz_cookie){info_agorabiz_cookie.style.display = "none";}
	}
//-->
</script>

$$INCL:BAS.HTM$$