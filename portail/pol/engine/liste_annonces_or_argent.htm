$$E:E3:CAT:159748:SLPRO$$
$$A:CSS_LISTEANN=1$$
$$INCL:HAUTX.HTM$$
$$DYN:ID3:NOCACHE:SQL$$
$$DYN:AUTH:CHECK_LOGIN:~authrequiredlevel:LOOSE$$
$$DYN:AUTH:UNIVERS_REDIRECT:~idunivers:1:~url:/156455/cnt.htm$$
$$DYN:AUTH:UNIVERS_REDIRECT:~idunivers:4:~url:slpro_regions.htm$$
$$E:SLPRO:INFOSAGENCE$$
$$E:POLEPOSITION:POSITION-OR-AR:ALIAS:CONTRAT$$

$$E:POLEPOSITION:DETERMINE-IDTYPEPUBLICATION:~idtypepublication:QRY:IDTYPEPUBLICATION:ALIAS:IDTP$$

$$B:POLEPOSITION:LISTE-CONTRATS-OR-ARGENT:~idtypepublication:VAL:IDTP_CURRENTIDTYPEPUB:ALIAS:CORAR$$

$$E:SLPRO:PUBLICATIONS:~idtypepublication:VAL:IDTP_CURRENTIDTYPEPUB:~si_web:1:ALIAS:PUBL$$
$$B:POLEPOSITION:LISTE-ANNONCES-OR-ARGENT:~idtypepublication:VAL:IDTP_CURRENTIDTYPEPUB:ALIAS:ORAR$$


<img src="$$_$$i/ORAG-SLPRO.jpg" />
<div align="right" ><a href="http://selogerpro.com/z/portail/pol/download/pdf/Guide d' utilisation Annonces Or et Argent.pdf" >Pour en savoir plus cliquez-ici</a> </div>
<br/>

<script src="$$_$$js/jquery-1.11.0.min.js" ></script>
<script src="$$_$$js/jquery.validate.min.js" ></script>
<script src="$$_$$js/jquery.validate.additional-methods.min.js" ></script>
<script type="text/javascript" >
//	function DisplayMedal(color, idannonce, idpub, typeattr, coex, callback) {
//		var strHtml;
//		/*
//		alert(color);
//		if (color == 'gold')
//			strHtml = 'Annonce Or';
//		if (color == 'silver'
//			strHtml = 'Annonce Argent';
//		document.write(strHtml);
//		*/
//		if(typeattr == '1') {
//			strHtml = '<img id="medal_black_' + idannonce + '" src="$$_$$i/medal_black.png" border="0" />';
//			document.write(strHtml);
//			return;
//		}
//		if(idpub == '34' && coex == '1') {
//			strHtml = '<img id="medal_black_' + idannonce + '" src="$$_$$i/medal_black.png" border="0" />';
//			document.write(strHtml);
//			return;
//		}

//        strHtml = '<img class="medal_on" data-idannonce="' + idannonce + '" id="medal_' + color + '_on_' + idannonce + '" src="$$_$$i/medal_' + color + '_on.png" border="0" />'; // onclick="javascript:MedalOnOff(\'medal_' + color + '_on_' + idannonce + '\', \'' + idpub + '\')"
//        strHtml += '<img class="medal_off" data-idannonce="' + idannonce + '" id="medal_' + color + '_off_' + idannonce + '" src="$$_$$i/medal_' + color + '_off.png" border="0" />'; //  onclick="javascript:MedalOnOff(\'medal_' + color + '_off_' + idannonce + '\', \'' + idpub + '\')"
//        strHtml += '<input type="hidden" data-idannonce="' + idannonce + '" class="medal_form" id="polepoar_' + idannonce + '_' + idpub + '">';
//		document.write(strHtml);

//		$('#medal_' + color + '_on_' + idannonce).click(function (e) {
//		    var target = $(e.target);

//		    if (callback != undefined) {
//		        if (!callback(e))
//		            return false;
//		    }

//		    MedalOnOff(target.attr("id"), idpub);
//		});
//		$('#medal_' + color + '_off_' + idannonce).click(function (e) {
//		    var target = $(e.target);

//		    if (callback != undefined) {
//		        if (!callback(e))
//		            return false;
//		    }

//		    MedalOnOff(target.attr("id"), idpub);
//		});

//		$('#medal_' + color + '_off_' + idannonce).css('display', 'none');
//		return;
//	}

	function confirm_message_callback(e) {
	    var target = $(e.target);
//	    if (target.hasClass("medal_on")) {
//	        var idannonce = target.data("idannonce");
//	        var trannonce = $("#liste-annonce .annonce" + idannonce);
//	        ref = trannonce.data("refannonce");
//	        return confirm("Confirmez-vous la suppression des annonces diffusées en annonce or et/ou argent : réf, réf, .... ");
//        }
        return true;
	}

	// Note: la macro supprime les données dont l'attribut "name" est défini: pour ne pas supprimer une donnée, on met l'attribut "name" à vide.
	// Et pour la supprimer, on recopie la valeur de l'attribut "id" dans l'attribut "name"
//	function MedalOnOff(id, idpub) {
//		var idannonce = id.replace("medal_silver_on_", "").replace("medal_silver_off_", "").replace("medal_gold_on_", "").replace("medal_gold_off_", "");
//		
//		if(id.indexOf("medal_silver_on_") != -1) { // On a cliqué sur medal_silver_on ==> on passe à medal_silver_off ==> On veut supprimer la ligne
//			$("#medal_silver_on_" + idannonce).css('display', 'none');
//			$("#medal_silver_off_" + idannonce).css('display', 'inline');
//			$('#polepoar_' + idannonce + '_' + idpub).attr('name', $('#polepoar_' + idannonce + '_' + idpub).attr('id'));
//		}

//		if(id.indexOf("medal_silver_off_") != -1) {
//			$("#medal_silver_off_" + idannonce).css('display', 'none');
//			$("#medal_silver_on_" + idannonce).css('display', 'inline');
//			$('#polepoar_' + idannonce + '_' + idpub).attr('name', '');
//		}
//		
//		if(id.indexOf("medal_gold_on_") != -1) {
//			$("#medal_gold_on_" + idannonce).css('display', 'none');
//			$("#medal_gold_off_" + idannonce).css('display', 'inline');
//			$('#polepoar_' + idannonce + '_' + idpub).attr('name', $('#polepoar_' + idannonce + '_' + idpub).attr('id'));
//		}

//		if(id.indexOf("medal_gold_off_") != -1) {
//			$("#medal_gold_off_" + idannonce).css('display', 'none');
//			$("#medal_gold_on_" + idannonce).css('display', 'inline');
//			$('#polepoar_' + idannonce + '_' + idpub).attr('name', '');
//		}

	//	}

	function checkFormField(form, fieldName, maxlimit, fieldlabel) {
	    var field = form.find('input[name="' + fieldName + '"]');
	    if (field.length == 0)
	        return true;
	    var value = field.val();

	    if (value <= maxlimit)
	        return true;
	    return confirm('le champs "' + fieldlabel + '" à une valeur supérieure à 5 000 000. Etes-vous sûr d\'avoir entré la bonne valeur ?');
	}

	function validateMSform(formselector, idniveaupolepo) {
	    var form = $(formselector);
	    if (!form.valid())
	        return false;

	    var select = form.find("select[name='idTypeAttribution']");

	    var value = select.val();
	    var oldvalue = select.data("oldvalue");

	    var displayname = "Argent";
	    if (idniveaupolepo == 3)
	        displayname = "Or";

	    if (!checkFormField(form, 'prixMinL', 5000000, 'Prix minimum location'))
	        return false;
	    if (!checkFormField(form, 'prixMaxL', 5000000, 'Prix maximum location'))
	        return false;
	    if (!checkFormField(form, 'prixMinV', 5000000, 'Prix minimum vente'))
	        return false;
	    if (!checkFormField(form, 'prixMaxV', 5000000, 'Prix maximum vente'))
	        return false;

	    if (oldvalue == value && value == 1)
	        return confirm("Pour les annonces " + displayname + ", vous avez modifié les filtres du mode de sélection des annonces. " 
                            + "\nLes annonces automatiques qui ne correspondent plus aux nouveaux critères seront désélectionnées.");
	    if (oldvalue == value)
	        return true;
	    if (value == 1)
	        return confirm("Pour les annonces " + displayname + ', vous avez choisi de passer en mode de sélection Manuel/Automatique. ' 
                            + '\nDes annonces seront ajoutées automatiquement de manière à utiliser au maximum votre réserve d\'annonces. '
                            + '\nSi vous choisissez manuellement des annonces, les annonces automatiques en trop seront automatiquement déselectionnées.');
	    if (value == 2)
	        return confirm("Pour les annonces " + displayname + ', vous avez choisi de passer en mode de sélection 100% Manuel. ' 
                            + '\nToutes les annonces sélectionnées de façon automatique seront désélectionnées. ' 
                            + '\nEtes-vous sûr de vouloir faire cela ?');
	    return true;
	}

	function validateform() {
	    var forms = $('.delete-field');
	    var list = [];
	    var i = 0;

	    while (i < forms.length) {
	        var field = $(forms[i]);
	        if (field.is(":checked"))
	            list.push(field.data("refannonce"));
	        ++i;
	    }

	    if (list.length == 0)
	        return false;

	    var refstr = list[0].toString();
	    if (list.length > 1) {
	        i = 1;
	        while (i < list.length) {
	            refstr += ', ' + list[i];
	            ++i;
	        }
	    }

	    return confirm("Confirmez-vous la suppression des annonces diffusées en annonce or et/ou argent : " + refstr);
	}

	$(document).ready(function () {
	    $('ms-form-or').validate();
	    $('ms-form-ar').validate();

	    $("#validate-delete-btn").click(function (e) {
	        if (validateform()) {
	            $('#delete-form').submit();
	        }
	        e.preventDefault();
	        e.stopPropagation();
	        return false;
	    });
	});

</script>

$$IF:ERRE$$<div class="erre" ><span>$$ERRE$$</span></div>$$END$$

$$IF0:CONTRAT:CONTRATEXIST$$		
	<div class="erre"><span>Vous n’avez pas souscrit à la mise en avant annonce Or ou annonce Argent.</span></div>
$$END$$	
	
$$IF:CONTRAT:CONTRATEXIST$$	

	
		
$$BIF:CORAR$$
$$IF=:1:CORAR:NBR$$ 
    Vous avez souscrit à la mise en avant Annonce(s) Or et/ou Argent sur $$DO$$ $$CORAR:PUBLICATION$$ $$LOOP$$
$$END$$

$$IF!:1:CORAR:NBR$$
    <form id="query_form" method="get" action="/liste_annonces_or_argent.htm" >		
        Vous avez souscrit à la mise en avant Annonce(s) Or et/ou Argent sur :
        <select name="idTypePublication" >
        $$DO$$
            $$IFPREV:CORAR:IDTYPEPUBLICATION$$
		        <option value="$$CORAR:IDTYPEPUBLICATION$$" $$IF=:IDTP_CURRENTIDTYPEPUB:CORAR:IDTYPEPUBLICATION$$ selected="selected" $$END$$ > 
                    $$CORAR:PUBLICATION$$ 
                </option>
            $$END$$
        $$LOOP$$
        </select>
        $$INFOS$$
		<input type="submit" value="Continuer" />
	</form>
$$END$$

$$BFIN$$
 
 
<br/>



$$IF:IDTP:CURRENTIDTYPEPUB$$
		
	$$IF:ORAR:NBPOLEPO1$$	$$ORAR:NBPOLEPO1$$ annonce(s) $$IF=:3:ORAR:IDNIVEAUPOLEPO1$$ Or $$END$$$$IF=:2:ORAR:IDNIVEAUPOLEPO1$$ Argent $$END$$ 	$$END$$  <br/>
	$$IF:ORAR:NBPOLEPO2$$	$$ORAR:NBPOLEPO2$$ annonce(s) $$IF=:3:ORAR:IDNIVEAUPOLEPO2$$ Or $$END$$$$IF=:2:ORAR:IDNIVEAUPOLEPO2$$ Argent $$END$$ 	$$END$$  <br/>
	
	
    $$BIF0:ORAR$$<h4>Vous n'avez pas d'annonces Or ou Argent dans votre sélection.</h4>$$BFIN$$

	$$IF:POLEPOSITION:SUPPRESSION_SELECTION_OR_ARGENT:ERRE$$
	<span style="color:green">$$POLEPOSITION:SUPPRESSION_SELECTION_OR_ARGENT:ERRE$$</span><br /><br />
	$$END$$
	<BR />

	$$BIF:ORAR$$
	<!-- Votre sélection comporte $$ORAR:NBR$$ annonce $$ORAR:NBR pluriel$$ Or & Argent -->
	Vous avez dans votre sélection d’annonce(s) Or et/ou Argent :
    <div id="selected-polepo-or" style="display:none;" ></div>
    <div id="selected-polepo-argent" style="display:none;" ></div>
	<script type="text/javascript" >
	    $(document).ready(function () {
	        var nbar = $("#liste-annonce tr.polepo2").length;
	        if (nbar > 0) {
	            var selecarg = $("#selected-polepo-argent");
	            if (nbar == 1)
	                selecarg.html("1 annonce Argent");
	            else
	                selecarg.html(nbar + " annonces Argent");
	            selecarg.show();
	        }

	        var nbor = $("#liste-annonce tr.polepo3").length;
	        if (nbor > 0) {
	            var selecor = $("#selected-polepo-or");
	            if (nbor == 1)
	                selecor.html("1 annonce Or");
	            else
	                selecor.html(nbor + " annonces Or");
	            selecor.show();
	        }

	    });
    </script>

	<form method="post" id="delete-form" >
	<input type="hidden" name="page_ok" value="/$$REP:URI$$" />
	<input type="hidden" name="page_err" value="/$$REP:URI$$" />
	<input type="hidden" id="u" name="u" value="POLEPOSITION:SUPPRESSION_SELECTION_OR_ARGENT" />
	<table id="liste-annonce" class="tabinfo" cellpadding="0" cellspacing="0" >
		<tr>
			<!--<th class="bdr" >Id Annonce</th>-->
			<th class="bdr" >Ref Annonce</th>
			<th class="bdr" >Type transaction</th>
			<th class="bdr" >Type bien</th>
			<th class="bdr" >CP</th>
			<th class="bdr" >Ville</th>
			<th class="bdr" >Prix</th>
            <th class="bdr" >Nb Visuels</th>
			<th class="bdr" >Publication validée</th>
			<th class="bdr" >Mode de sélection</th>
			<th class="bdr" >Type</th>
			<th class="bdr" >Supprimer</th>
		</tr>
		$$DO$$
		<tr class="line_$$IF=:0:ORAR:I mod2 0 1$$pair$$END$$$$IF!:0:ORAR:I mod2 0 1$$impair$$END$$_new polepo$$ORAR:IDNIVEAUPOLEPO$$ annonce$$ORAR:IDANNONCE$$" data-refannonce="$$ORAR:REFANNONCE$$" >
			$$REM$$<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Id Annonce] body=[$$ORAR:IDANNONCE$$]">$$ORAR:IDANNONCE$$</td>$$END$$
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Id Annonce] body=[$$ORAR:REFANNONCE$$]"><a href="/$$ORAR:IDANNONCE$$/p_visuann.htm" >$$ORAR:REFANNONCE$$</a></td>
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Type de transaction] body=[$$ORAR:TYPETRANSACTION$$]">$$ORAR:TYPETRANSACTION$$</td>
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Type de bien] body=[$$ORAR:TYPEBIEN$$$$IF:ORAR:SOUSTYPEBIEN$$ - $$ORAR:SOUSTYPEBIEN$$$$END$$]">$$ORAR:TYPEBIEN$$</td>
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Code Postal] body=[$$ORAR:CP$$]">$$ORAR:CP$$</td>
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Ville] body=[$$ORAR:VILLE$$]">$$ORAR:VILLE$$</td> 
			<td class="bdrnopointer" title="header=[<img src='$$_$$i/picto_info.gif' style='vertical-align:middle'>&nbsp;&nbsp;Prix] body=[$$ORAR:PX$$]">$$ORAR:PX$$</td> 
			<td class="bdrnopointer" >$$ORAR:NBVISUELS$$</td> 
            <td class="bdrnopointer" >$$IF=:True:ORAR:ISVALID$$Oui$$END$$ $$IF=:False:ORAR:ISVALID$$Non$$END$$</td> 
			<td class="bdrnopointer" >
                $$IF=:1:ORAR:IDTYPEATTRIBUTION$$ Automatique $$END$$ 
                $$IF=:2:ORAR:IDTYPEATTRIBUTION$$ Manuel $$END$$ 
            </td> 
			<td class="bdrnopointer" >
                $$IF=:3:ORAR:IDNIVEAUPOLEPO$$ Or $$END$$
                $$IF=:2:ORAR:IDNIVEAUPOLEPO$$ Argent $$END$$
            </td> 
			<td class="bdrnopointer" >
            $$IF=:2:ORAR:IDTYPEATTRIBUTION$$
                $$IF=:3:ORAR:IDNIVEAUPOLEPO$$
                    <input type="checkbox" value="1" class="delete-field" data-refannonce="$$ORAR:REFANNONCE$$" name="polepoor_$$ORAR:IDANNONCE$$_$$IDTP:CURRENTIDTYPEPUB$$" /> 
                $$END$$
                $$IF=:2:ORAR:IDNIVEAUPOLEPO$$
                    <input type="checkbox" value="1" class="delete-field" data-refannonce="$$ORAR:REFANNONCE$$" name="polepoar_$$ORAR:IDANNONCE$$_$$IDTP:CURRENTIDTYPEPUB$$" /> 
                $$END$$
            $$END$$
            $$IF=:1:ORAR:IDTYPEATTRIBUTION$$ - $$END$$ 
				<!--$$REM$$<script type="text/javascript" >DisplayMedal( '$$IF=:2:ORAR:IDNIVEAUPOLEPO$$silver$$END$$$$IF=:3:ORAR:IDNIVEAUPOLEPO$$gold$$END$$' , $$ORAR:IDANNONCE$$, '$$IDTP:CURRENTIDTYPEPUB$$', '$$IF=:2:ORAR:IDNIVEAUPOLEPO$$2$$END$$$$IF=:3:ORAR:IDNIVEAUPOLEPO$$3$$END$$', '$$ORAR:COEX$$', confirm_message_callback)</script>$$END$$-->
			</td> 
		</tr>
		$$LOOP$$	
	</table>
	<div align="right" >
		<input type="button" id="validate-delete-btn" value="Valider les suppressions" /> 
	</div>
    </form>
	$$BFIN$$
	
	<!-- Si vous souhaitez sélectionner manuellement vos annonces Or ou Argent, <a href="/canaux_diffusion.htm" >cliquez ici</a> pour retrouver la liste de toutes vos annonces et procéder à votre nouvelle sélecion.
	--> 
	<div align="right" > 
	    <input type="button" value="Ajouter d'autres annonces Or/Argent" onclick="self.location.href='/canaux_diffusion.htm'" /> 
	    <br />
        <br />
    </div>
	$$INCL:POLEPOSITIONCRITERES.HTM$$
		
$$END$$
$$END$$


$$INCL:BASX.HTM$$