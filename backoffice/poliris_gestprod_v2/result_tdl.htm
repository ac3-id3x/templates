$$REM$$
====================================================================
//// <summary>Affichage les campagnes tête de liste</summary>
//// <remarks>
//// <para>Pages html inclues : incl_haut.htm, incl_bas.htm, incl_result_tdl.htm</para>
//// </remarks>
//// <update date="2008-01-08" author="ext-christian.malheiro">Création</update>
====================================================================
$$END:REM$$

$$INCL:HAUT.HTM$$



<script src="$$_$$javascript/prototype.js" type="text/javascript"></script>
<script src="$$_$$javascript/scriptaculous.js?load=effects" type="text/javascript"></script>
<script language="javascript" type="text/javascript">
<!--

/********************************************
Permet l'insertion dans les macros d'ajout/maj de click
et d'ajout/maj de dossier tdl.
********************************************/
function ajout_modif_supp( elt )
{
	var element = document.getElementById(elt);
	//var hidden1 = document.getElementById('hid');
	var hidden2 = document.getElementById('hid2');

	if((element.name == 'bt_ajout') || (element.name == 'bt_ajout_tdl'))
	{
		//hidden1.value = '1';
		hidden2.value = '1';
	}
	if((element.name == 'bt_maj') || (element.name == 'bt_maj_tdl'))
	{
		//hidden1.value = '2';
		hidden2.value = '2';
	}
	if(element.name == 'bt_sup')
	{
		//hidden1.value = '3';
	}


}

function replace( elt )
{
	var element = document.getElementById(elt);
	var elemenValue = element.value;
	element.value = elemenValue.replace(".", ",");
}

function submitform()
{
	var elt_idlangue = document.getElementById("langue");
	var url = "";
	if( elt_idlangue )
	{
		url = "/" + elt_idlangue.value + "/$$REP:2$$/$$REP:1$$/$$REP:0$$";
	}
	if( url )
	{
		document.location.href = url;
	}
}

function confirmation(NameForm,Expression,IdKeywords)
{
	var texte = "Etes vous sûr de vouloir supprimer l'expression '" + Expression + "' ?";

	if(confirm(texte))
	{
		// Suppression de l'expression
		eval("document." + NameForm + ".idkeywords.value = '" + IdKeywords + "_d';" );
		eval("document." + NameForm + ".submit();");
	}
}

function clear_field(elt)
{
	document.getElementById(elt).value = '';
	//element.value = '';
}

function GetAnnee()
{
	TodayDate = new  Date  () ;
	if (navigator.appName == 'Netscape')
	{
		var nAnnee = TodayDate.getYear();
		if (nAnnee < 100) nAnnee += 2000;
		if (nAnnee > 100&&nAnnee < 2000) nAnnee += 1900;
		return nAnnee;
	}
	else return TodayDate.getYear();
}




function verif_date(name_champ)
{

	var jour,mois,annee,annee_max,annee_min,erreur,date_saisie,Mois_page,Jour_page,Mois_now,Jour_now,date_now,date_page;
	var annee_test,mois_test,jour_test;
	//document.formulaire.dt_suivi_dossier_j.value;
	jour = document.getElementById(name_champ+'j').value;
	//document.formulaire.dt_suivi_dossier_m.value;
	mois = document.getElementById(name_champ+'m').value;
	//document.formulaire.dt_suivi_dossier_y.value;
	annee = document.getElementById(name_champ+'y').value;
	//date construite a partir des variables jour mois et annee

	if ((jour!="") && (mois!="") && (annee!=""))
	{
			date_s=new Date(annee , mois , jour);
			Mois_page=date_s.getMonth();
			if(Mois_page<=9)
			{
				Mois_page="0" + date_s.getMonth();
			}
			Jour_page=date_s.getDate();
			if(Jour_page<=9)
			{
				Jour_page="0" + date_s.getDate();
			}
			
			date_page=date_s.getFullYear().toString() + Mois_page + Jour_page;
	}else  
		{
			date_page="29991231";
		}
	

	Today = new  Date  () ;
	Mois_now=Today.getMonth();
	if(Today.getMonth()<=9)
	{
		Mois_now="0" + (Today.getMonth()+1);
	}
	Jour_now=Today.getDate();
	if(Today.getDate()<=9)
	{
		Jour_now="0" + Today.getDate();
	}
	date_now=Today.getFullYear().toString() + Mois_now + Jour_now;
	var anneecourante = GetAnnee();
	annee_max = anneecourante + 2;
	erreur="";
	annee_min = anneecourante - 2;
	

	if(jour != "" && (jour<1 || jour>31))
	{
		erreur = "Le jour doit être compris entre 1 et 31\n";
		//document.getElementById(name_champ).value="";
		//document.getElementById(name_champ).focus();
	}
	if(mois !="" && (mois<1 || mois > 12))
	{
		erreur = "Le mois doit être compris entre 1 et 12\n";
		//document.getElementById(name_champ).value="";
		//document.getElementById(name_champ).focus();
	}
	if(annee !="" && (annee<annee_min || annee > annee_max ) )
	{
		erreur = "L'année doit se trouver dans un intervalle de deux ans\n";
		//document.getElementById(name_champ).value="";
		//document.getElementById(name_champ).focus();
	}


	if (erreur== "")
	{
	  if((date_page>date_now) && (date_page != "29991231"))
		{
				erreur = "date de début de campagne superieur a la date du jour\n";
		}
	}

	if(erreur !="")
	{
		alert(erreur);
	}

}

function AfficheDate()
{
		TodayDate = new  Date() ;
		var jour, mois, annee;
		jour = TodayDate.getDate();
		mois = TodayDate.getMonth();
		annee = TodayDate.getYear();

		document.getElementById('dt_record_j').value = jour;
		document.getElementById('dt_record_m').value = TodayDate.getMonth()+1;
		//document.getElementById('dt_record_a').value = TodayDate.getYear();
		document.getElementById('dt_record_a').value = GetAnnee();
}

// Envoi des mails agence
	function sendmail_tdl()
	{
	  	popup('sendmail','/$$FORM:IDCOMMERCIAL$$/$$REP:1$$/sendmail.htm',500,500,0);
	}
//-->
</script>
<br><br><br><br><br>
<table id="conteneur" name="conteneur" >
	<tr>
		$$IF0:FORM:POPUP$$
		<td id="menugauche" name="menugauche">
			<ul class="menugauche_principal">
				<li><a href="/$$REP:1$$/Dossier.htm" >Retour au dossier</a></li>
			</ul>
		</td>
		$$END$$
		$$IF:FORM:POPUP$$<td>&nbsp;</td>$$END$$
		<td id="principal" name="principal">
			$$INCL:RESULT_TDL.HTM$$
		</td>
	</tr>
	<tr>
	    <td colspan="2" class="cadreclair">$$INCL:RESULT_TDL_STAT.HTM$$</td>
	</tr>
</table>
$$INCL:BAS.HTM$$
