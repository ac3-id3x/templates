$$REM$$
====================================================================
//// <summary>Page de recherche multi-critère de dossier</summary>
//// <remarks>
//// <para>Pages html inclues : </para>
//// <para>Liste des macros B utilisées : GDP2:LISTE_PRODUIT, GDP2:LISTE_ETAT, GDP2:ZONE_SELECT </para>
//// </remarks>
//// <update date="2007-11-15" author="florian.adam"></update>
//// <update date="2007-12-06" author="jean-jacques.durmord">Rajout de la condition actif du produit</update>
====================================================================
$$END:REM$$

$$B:GDP2:LISTE_PRODUIT:~PROTYPE:1:ALIAS:LISTE_PRODUIT$$
$$B:GDP2:LISTE_PRODUIT:~PROTYPE:2:ALIAS:LISTE_PRODUIT2$$
$$B:GDP2:LISTE_ETAT:~TRI:1:ALIAS:ETAT1$$
$$B:GDP2:LISTE_ETAT:~TYPEETAT:0:ALIAS:ETATPRINCIPAUX$$
$$B:GDP2:LISTE_ETAT:~TYPEETAT:1:ALIAS:PLUSETATSITE$$
$$B:GDP2:LISTE_ETAT:~TYPEETAT:2:ALIAS:PLUSETATREF$$
$$B:GDP2:ZONE_SELECT:~TYPE:4:ALIAS:COMMERCIAUX$$
$$B:GDP2:ZONE_SELECT:~TYPE:5:ALIAS:RESPONSABLES$$
$$B:GDP2:ZONE_SELECT:~TYPE:6:ALIAS:INTERVENANTS$$
$$B:GDP2:ZONE_SELECT:~TYPE:7:ALIAS:PRESTATAIRES$$

<form action="recherche_resultat.htm" id="frmrecherche" name="frmrecherche" method="get"  onSubmit="return validate('frmrecherche',var_MCD,msg_MCD);" >
<input type="hidden" name="typeetat" id="typeetat" value="1" />
<table class="cent_pourcent">
	<tr>
		<td>
			<h1>recherche multi-critères</h1>
			<div id="type_dossier">
				<table>
					<caption><h2>Type de dossier</h2></caption>
					<tr>
						<td>
							<h1 class="case_orange">sites agences</h1>
						</td>
						<td>
							<h1 class="case_bleu">référencement</h1>
						</td>
					</tr>
					<tr>
						$$BIF:LISTE_PRODUIT$$
						<td>
							$$DO:2:99$$
								$$IF=:OUI:LISTE_PRODUIT:PRO_SI_VISIBLE$$
									<input type="checkbox" id="idproduit_$$LISTE_PRODUIT:IDPRODUIT$$" name="idproduit" value="$$LISTE_PRODUIT:IDPRODUIT$$" $$IF!:1:FORM:CHKMODIF$$ $$IF(:FORM_IDPRODUIT:LISTE_PRODUIT:IDPRODUIT$$checked$$END$$ $$END:CHKMODIF$$ />
									<label>$$LISTE_PRODUIT:PRO_LIBELLE$$ </label><br/>
									$$IF=:LISTE*PRODUIT_NBR:LISTE_PRODUIT:I$$
										<input type="checkbox" id="chkModif" name="chkModif" value="True" $$IF(:1,True:FORM:CHKMODIF$$checked$$END:CHKMODIF$$ />
										<label>Site en modification </label>
									$$END$$
								$$END$$
							$$LOOP$$
						</td>
						$$BFIN$$
						$$BIF0:LISTE_PRODUIT$$
							<td>
								Impossible d'afficher la liste des produits sites disponibles
							</td>
						$$BFIN$$
						$$BIF0:LISTE_PRODUIT$$
							<td colspan="2">
								Un problème empêche d'afficher la liste des produits. Contactez le service d'informatique de Gestion.
							</td>
						$$BFIN$$
						$$BIF:LISTE_PRODUIT2$$
							<td>
								$$DO:2:99$$
									$$IF=:OUI:LISTE_PRODUIT2:PRO_SI_VISIBLE$$
										<input type="checkbox" id="idproduit_$$LISTE_PRODUIT2:IDPRODUIT$$" name="idproduit" value="$$LISTE_PRODUIT2:IDPRODUIT$$" $$IF(:FORM_IDPRODUIT:LISTE_PRODUIT2:IDPRODUIT$$checked$$END$$ />
										<label>$$LISTE_PRODUIT2:PRO_LIBELLE$$ </label><br/>
									$$END$$
								$$LOOP$$
							</td>
						$$BFIN$$
						$$BIF0:LISTE_PRODUIT2$$
							<td colspan="2">
								Un problème empêche d'afficher la liste des produits. Contactez le service d'informatique de Gestion.
							</td>
						$$BFIN$$
					</tr>
				</table>
			</div>

				<table  class="cent_pourcent">
					<tr>
						<td>
							<caption><h2>Etat du dossier</h2></caption>
						</td>
					</tr>
					<tr>
						$$BIF:ETATPRINCIPAUX$$
						<td>
								$$DO$$
								$$IF=:0:ETATPRINCIPAUX:TYPEETAT$$
									<input type="checkbox" $$IF(:FORM_IDETAT:ETATPRINCIPAUX:IDETAT$$checked$$END$$ id="idetat" name="idetat" value="$$ETATPRINCIPAUX:IDETAT$$" />
									<label>$$ETATPRINCIPAUX:ETAT_DESCRIPTION$$</label>
								$$END$$
								$$LOOP$$
							<a href="#" class="aOrange" onclick="javascript:slide_div('div_etat', div_etat_title, 'd\'états', null, null);"><span id="div_etat_title">Plus d'états</span></a>
						</td>
						$$BFIN$$
						$$BIF0:ETATPRINCIPAUX$$
						<td colspan="2">
							Un problème empêche d'afficher la liste des &eacute;tats. Contactez le service d'informatique de Gestion.
						</td>
						$$BFIN$$
					</tr>
					<tr>
						<td>
							<table id="div_etat" style="visibility:hidden;">
								<tr bgcolor="#F0F1EB">
									$$BIF:PLUSETATSITE$$
									<td>
										$$DO:2$$
											<input type="checkbox" $$IF(:FORM_IDETAT:PLUSETATSITE:IDETAT$$checked $$END$$ name="idetat" value="$$PLUSETATSITE:IDETAT$$"/></nobr>
											<label width="20px" >$$PLUSETATSITE:ETAT_DESCRIPTION$$</label><br/>
											$$IF(:FORM_IDETAT:PLUSETATSITE:IDETAT$$
												<script>slide_div('div_etat', 'div_etat_title', 'd\'états');</script> 
											$$END$$
										$$LOOP$$
									</td>
									$$BFIN$$
									$$BIF0:PLUSETATSITE$$
									<td colspan="2">
										Un problème empêche d'afficher la liste des &eacute;tats. Contactez le service d'informatique de Gestion.
									</td>
									$$BFIN$$
									$$BIF:PLUSETATREF$$
									<td>
									$$DO:2$$
										<input type="checkbox" $$IF(:FORM_IDETAT:PLUSETATREF:IDETAT$$checked$$END$$ name="idetat" value="$$PLUSETATREF:IDETAT$$" />
										<label>$$PLUSETATREF:ETAT_DESCRIPTION$$</label><br/>
										$$IF(:FORM:IDETAT:PLUSETATREF_IDETAT$$
											<script>slide_div('div_etat', 'div_etat_title', 'd\'états');</script>
										$$END$$
									$$LOOP$$
									</td>
									$$BFIN$$
									$$BIF0:PLUSETATREF$$
									<td colspan="2">
										Un problème empêche d'afficher la liste des &eacute;tats. Contactez le service d'informatique de Gestion.
									</td>
									$$BFIN$$
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td>
							<table class="cent_pourcent">
								<tr>
									<td>
										<caption><h2>Date de </h2></caption>
									</td>
								</tr>
								<tr>
									<td>
										<select name="cboPlageEtat">
											$$BIF:ETAT1$$
											$$DO$$
											<option value="$$ETAT1:IDETAT$$" 
														$$IF=:FORM_CBOPLAGEETAT:ETAT1:IDETAT$$selected="selected"$$END$$
														>
												$$ETAT1:ETAT_DESCRIPTION$$
											</option>
											$$LOOP$$
											$$BFIN$$
										</select>
									&nbsp;du&nbsp;
									<input type="text" name="dateD" id="dateD" value="$$FORM:DATED$$" size="10" />&nbsp;au&nbsp;
									<input type="text" name="dateF" id="dateF" value="$$FORM:DATEF$$" size="10" />&nbsp;(jj/mm/aaaa)&nbsp;
									<a class="Aorange" href="javascript:EffacementDate()">Effacer les dates</a><br/><br/>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr>
						<td>
						<table class="cent_pourcent">
							<tr>
								<td>
									<caption><h2>Dossier</h2></caption>
								</td>
							</tr>
							<tr>
								<td>
									<label for="dos_nom">Nom du dossier :</label>
								</td>
								<td>
										<input type="text" name="dos_nom" value="$$FORM:DOS_NOM$$" />
								</td>
								<td>
$$REM$$									<label for="code_agence">Code agence : </label>$$END$$&nbsp;
								</td>
								<td>
$$REM$$										<input type="text" name="code_agence" value="$$FORM:CODE_AGENCE$$" />$$END$$&nbsp;
								</td>
								<td>
									<label for="num_compte_tdl">Numéro de compte TDL : </label>
								</td>
								<td>
										<input type="text" name="num_compte_tdl" value="$$FORM:NUM_COMPTE_TDL$$" />
								</td>
							</tr>
							<tr>
								<td>
									<label for="dos_url">Url : </label>
								</td>
								<td>
										<input type="text" name="dos_url" value="$$FORM:DOS_URL$$" />
								</td>
								<td>
									<label for="cp">Code postal /dép : </label>
								</td>
								<td>
										<input type="text" name="cp" value="$$FORM:CP$$" />
								</td>
								<td>
									<label for="nom_groupe_annonce">Nom du groupe d'annonce :</label>
								</td>
								<td>
										<input type="text" name="nom_groupe_annonce" value="$$FORM:NOM_GROUPE_ANNONCE$$" />
								</td>
							</tr>
<!--
							<tr>
								<td>
									<label for="num_tel">Téléphone [Webtel]</label>
								</td>
								<td>
										<input type="text" name="num_tel" value="$$FORM:NUM_TEL$$" />
								</td>
							</tr>
-->
						</table>
					</td>
				</tr>
				<tr>
					<td>
						<table class="cent_pourcent">
							<tr>
								<td>
									<caption><h2>Ressources</h2></caption>
								</td>
							</tr>
							<tr>
								<td>
									<label>Responsable :</label>
								</td>
								<td>
									<select name="cboResponsable" >
										<option value="0">
											----------------
										</option>
										$$BIF:RESPONSABLES$$
										$$DO$$
											<option value="$$RESPONSABLES:ID$$" 
												$$IF=:FORM_CBORESPONSABLE:RESPONSABLES:ID$$ selected="selected" $$END$$>
												$$RESPONSABLES:VALEUR$$
											</option>
										$$LOOP$$
										$$BFIN$$
									</select>
								</td>
								<td>
									<label>Commercial :</label>
								</td>
								<td>
									<select name="cboCommercial">
										<option value="0">
											----------------
										</option>
										$$BIF:COMMERCIAUX$$
										$$DO$$
										<option value="$$COMMERCIAUX:ID$$"
												$$IF=:FORM_CBOCOMMERCIAL:COMMERCIAUX:ID$$ selected="selected" $$END$$ >
											$$COMMERCIAUX:VALEUR$$
										</option>
										$$LOOP$$
										$$BFIN$$
									</select>
								</td>
							</tr>
							<tr>
								<td>
									<label>Intervenant :</label>
								</td>
								<td>
									<select name="cboIntervenant" >
										<option value="0">
											----------------
										</option>
										$$BIF:INTERVENANTS$$
										$$DO$$
										<option value="$$INTERVENANTS:ID$$" 
											$$IF=:FORM_CBOINTERVENANT:INTERVENANTS:ID$$ selected="selected" $$END$$>
											$$INTERVENANTS:VALEUR$$
										</option>
										$$LOOP$$
										$$BFIN$$
									</select>
								</td>
								<td>
									<label>Prestataire :</label>
								</td>
								<td>
									<select name="cboPrestataire" >
										<option value="0">
											----------------
										</option>
										$$BIF:PRESTATAIRES$$
										$$DO$$
										<option value="$$PRESTATAIRES:ID$$" 
											$$IF=:FORM_CBOPRESTATAIRE:PRESTATAIRES:ID$$ selected="selected" $$END$$>
											$$PRESTATAIRES:VALEUR$$
										</option>
										$$LOOP$$
										$$BFIN$$
									</select>
								</td>
							</tr>
							<tr>
								<td colspan="5" align="right">
									<input type="submit" name="recherche_dossier" value="Rechercher" style="float:right;"/>
								</td>
							</tr>
						</table>
		</td>
	</tr>
</table>
</form>
<script >
	/*
					Valeur 	Origine 		Vérification 
				-------------------------------------------------------------------------------------------------------
				e 			Non vide 		L'élément ne doit pas être vide 
				n 			Nombre 			L'élément doit être un nombre 
				m 			Mail 				Une adresse élctronique doit être exacte sur la forme 
				r 			Regexp 			La valeur doit correspondre à un modèle déterminé 
				p 			Prix 				La valeur doit se présenter sous la forme "10,00" (avec virgule) 
				p. 			Prix_Point 	La valeur doit se présenter sous la forme "10.00" (avec point) 
				c 			Capitalize 	Les noms propres doivent être corrigés 
 				t				Longueur		Contrôle si on dépasse pas la taille max
 				d				Date				Contrôle si le format date est correct
	*/
		var msg_MCD = 'GESTPROD V2 - Erreur - Formulaire';

		var var_MCD = new Array();
		var_MCD[0] = new Array('dateD','d',': Le format de la date "DU" n\est pas correct','');
		var_MCD[1] = new Array('dateF','d',': Le format de la date "AU" n\est pas correct','');
		var_MCD[2] = new Array('num_tel','n',': Le format doit être un nombre','');
		var_MCD[3] = new Array('cp','n',': Le format doit être un nombre','');
		
		function EffacementDate()
		{
 			document.forms['frmrecherche'].elements['dateD'].value= '';		
			document.forms['frmrecherche'].elements['dateF'].value= '';
 
		}

</script>