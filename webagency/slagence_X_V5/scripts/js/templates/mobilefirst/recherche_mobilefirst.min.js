var countAnnonce=0,verif=3,count=0,regEmail=/^[0-9a-z._-]+@{1}[0-9a-z.-]{2,}[.]{1}[a-z]{2,5}$/i;function fixStar(a){$("#annonce"+a).find(".bouton-ajouter-selection-detail i").attr("class","mf-icon-star-full")}function countSelection(a){$(".bouton-selection-annonces").children("span").html("<strong>"+a+"</strong>")}
$(document).ready(function(){$("#recherche-resultats-listing").on("click",".bouton-comparer-selection-detail",function(){var a=$(this);a.hasClass("clickCompared")?a.removeClass("clickCompared").find("i").removeClass("mf-icon-star-full").addClass("mf-icon-star"):a.addClass("clickCompared").find("i").removeClass("mf-icon-star").addClass("mf-icon-star-full")});$("#recherche-resultats-listing").on("click",".bouton-supprimer-selection-detail",function(){var a=$(this).attr("data-idannonce"),b=$(this).attr("data-idpublication");
$.ajax({type:"GET",data:"idannonce="+a+"&idp="+b,dataType:"html",cache:!1,url:"/scripts,panier,selection_supprimer.htm",success:function(a){window.location.reload()},error:function(a,b){},complete:function(a,b){}})});$(".bouton-comparer-selection").on("click",function(){var a=$("html").attr("lang"),b=$(this).attr("data-imprimer"),c="",e=0;$(".clickCompared").each(function(){c+=$(this).attr("data-idannonce")+",";e++});0==e?($(".bouton-comparer-selection-detail").each(function(){$(this).addClass("clickCompared").find("i").removeClass("mf-icon-star").addClass("mf-icon-star-full");
c+=$(this).attr("data-idannonce")+","}),1==b?(a=window.open("recherche,incl_comparaison.htm?idannonces="+c+"&lang="+a,"Print","width=500,height=400"),a.focus(),a.print()):$(this).colorbox({width:"75%",height:"60%",iframe:!0,href:"recherche,incl_comparaison.htm?idannonces="+c+"&lang="+a+"&print="+b,close:"X",onLoad:function(){$("#colorbox").attr("style","outline:none")}})):1==b?(a=window.open("recherche,incl_comparaison.htm?idannonces="+c+"&lang="+a,"Print","width=500,height=400"),a.focus(),a.print()):
$(this).colorbox({width:"75%",height:"60%",iframe:!0,href:"recherche,incl_comparaison.htm?idannonces="+c+"&lang="+a+"&print="+b})});$("#form-tri").on("change","#trierAnnonce",function(){var a=$(this).val(),b=$("#form-tri").attr("action");window.location.href=b+("&tri="+a)});$(".bouton-vider-selection").on("click",function(a){a.preventDefault();$("#recherche-resultats-listing");$.ajax({type:"GET",cache:!1,url:"/scripts,panier,selection_vider.htm",success:function(a){window.location.reload(!0)}})});
$(".bouton-alerte-moteur").on("click",function(a){a.preventDefault();var b=$(this);b.button("loading");$.ajax({type:"POST",data:$("#form-alerte-moteur").serialize(),dataType:"json",url:"/alerte,incl_creation.htm",beforeSend:function(){$(".message-erreur-alerte").html("")},success:function(a){0<a.message.length?($(".message-erreur-alerte").html(a.message),0>=a.nom.length?$("#nom-alerte").parent().addClass("error").removeClass("success"):$("#nom-alerte").parent().removeClass("error").addClass("success"),
0>=a.email.length||0==regEmail.test(a.email)?$("#email-alerte").parent().addClass("error").removeClass("success"):$("#email-alerte").parent().removeClass("error").addClass("success")):0<a.idInscription.length&&($("#nom-alerte").parent().removeClass("error").removeClass("success"),$("#email-alerte").parent().removeClass("error").removeClass("success"),$(".message-erreur-alerte").html(inscriptionOK),b.next(".bouton-alerte-moteur-ga").trigger("click"))},error:function(a,b,d){console.log(a,b,d)},complete:function(){b.button("reset");
$(".message-erreur-alerte").show("slow").delay(1500).hide("slow")}})});$(".bouton-alerte-moteur2").on("click",function(a){a.preventDefault();var b=$(this);b.button("loading");$.ajax({type:"POST",data:$("#form-alerte-moteur2").serialize(),dataType:"json",url:"/alerte,incl_creation.htm",beforeSend:function(){$(".message-erreur-alerte").html("")},success:function(a){0<a.message.length?($(".message-erreur-alerte").html(a.message),0>=a.nom.length?$("#nom-alerte").parent().addClass("error").removeClass("success"):
$("#nom-alerte").parent().removeClass("error").addClass("success"),0>=a.email.length||0==regEmail.test(a.email)?$("#email-alerte").parent().addClass("error").removeClass("success"):$("#email-alerte").parent().removeClass("error").addClass("success")):0<a.idInscription.length&&($("#nom-alerte").parent().removeClass("error").removeClass("success"),$("#email-alerte").parent().removeClass("error").removeClass("success"),$(".message-erreur-alerte").html(inscriptionOK),b.next(".bouton-alerte-moteur2-ga").trigger("click"))},
error:function(a,b,d){console.log(a,b,d)},complete:function(){b.button("reset");$(".message-erreur-alerte").show("slow").delay(1500).hide("slow")}})})});