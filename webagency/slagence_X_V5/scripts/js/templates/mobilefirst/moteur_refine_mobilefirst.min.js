var divcontent=$("#recherche-listing"),noqry="",eachAnnonce="";$(document).ready(function(){function s(){if("#expiree"!=location.hash){var i=function(){var i={};return $("#Mini_Moteur input,select").filter(function(){var e=$(this).prop("name"),t=$(this).val();return e?(i[e]||(i[e]=[]),-1===i[e].indexOf(t)&&"saisie"!=e?(i[e].push(t),t):void 0):t}).serialize()}();$.ajax({type:"GET",data:i+"&ti="+(new Date).getTime(),cache:!1,dataType:"json",contentType:"application/json",url:"/moteur,refine,incl_refine_js_mobilefirst.js",beforeSend:function(){$(".layer,.layer-annonce").addClass("display-show").removeClass("display-none"),$(".text-opti-ref").html("")},success:function(e){location.hash=e.qry,$(".recherche-ttl-nb").html(e.ttl_nb),$(".recherche-ttl-more").html(e.ttl_more),$(".phrase-recherche").html(e.phrase),window.top.document.title=$(".phrase-recherche").text(),$("input[name='qry']").val(e.qry),$("input[name='phrase']").val(e.phrase),$("input[name='page_base']").val(lienAlerte+"?"+e.qry);var t=e.tri;$("#trierRefine").find("option").each(function(){$(this).val()==t&&$(this).attr("selected",!0)}),$.ajax({type:"GET",dataType:"html",cache:!1,data:i,url:"/recherche,incl_recherche_mobilefirst_ajax.htm",success:function(e){divcontent.html(e),$("#trierRefine").change(function(e){s()})},complete:function(e,t){$(".layer, .layer-annonce").addClass("display-none").removeClass("display-show"),$(".btn-tooltip").tooltip(),$.ajax({type:"GET",data:"&ti="+(new Date).getTime(),cache:!1,dataType:"json",contentType:"application/json",url:"/moteur,refine,incl_nbpanier.js",success:function(e){var t=e.idselected,i=e.nbpanier;if(0!=parseInt(i)){var a=t.length;for(n=0;n<a;n++)fixStar(t[n].idann)}countSelection(i)},error:function(e,t,i){},complete:function(e,t){}}),function(e){if(1==e)$("html, body").animate({scrollTop:0},600)}(1)}})}})}else location.hash=""}function r(){$("#Mini_Moteur").find("input,select").not("[name='idtt'],[name='saisie']").val(""),$(".ville-suggest-liste").html("")}function c(e,t,n,a,l){var o=e.split("|"),s=o.length,r="";for(i=0;i<s;i++){var c=$("#"+o[i]).val();r+=r+$("#"+o[i]).attr("name")+"="+c+"&"}a&&(r+=a+"&"),r+="typemoteur="+typemoteur+"&lang="+lang+"&style_budget="+typebudget,""!=$("#"+o[0]).val()&&($("."+t).each(function(){$(this).show()}),$.ajax({type:"GET",data:r,dataType:"html",sync:l,url:"/moteur,mini,incl_"+n+".htm",beforeSend:function(){$("."+t).each(function(){$(this).show()})},success:function(e){$("."+t).each(function(){$(this).show(),$(this).html(e),$("."+t).find("select").hasClass("multiselect")&&$("."+t+" .multiselect").multipleSelect()})}}))}$(".moteur-mobilefirst-mobile-toggle").click(function(){return $(".moteur-mobilefirst").addClass("is-active"),$("body").addClass("has-modal"),!1}),$(".moteur-mobilefirst-close").click(function(){$(".moteur-mobilefirst").removeClass("is-active"),$("body").removeClass("has-modal")}),$("#Mini_Moteur").length&&function(){var e=$("#idtypebien-hidden").val(),t=$("#pxmax").val(),i=window.location;if(""!=(a=i.hash.split("#"))){var n=a[1],a=n.split("&");for(r(),l=0;l<a.length;l++){"idtt"==(o=a[l].split("="))[0]&&$("[name='"+o[0]+"'").val(o[1])}for(l=0;l<a.length;l++){var o;"idtt"!=(o=a[l].split("="))[0]&&($("[name='"+o[0]+"'").val(o[1]),"idtypebien"==o[0]&&(e=o[1],$("#idtypebien-hidden").val(e)),"pxmax"==o[0]&&(t=o[1],$("#pxmax").val(t)),"px_loyermax"==o[0]&&(t=o[1],$("#pxmax").val(t)))}c("idtt","Mini_Biens","type_biens","idtypebien="+e,!1),c("idtt","Mini_Budget","budget_mobilefirst","pxmax="+t+"&px_loyermax="+t,!1),null!=n&&(s(),function(e){$.ajax({type:"GET",dataType:"html",cache:!1,data:e,url:"/moteur,suggest,incl_get_localisation_ajax.htm",success:function(e){$(".ville-suggest-liste").html(e)}})}(n))}else c("idtt","Mini_Biens","type_biens","idtypebien="+$("#idtypebien-hidden").val(),!0),c("idtt","Mini_Budget","budget_mobilefirst","pxmax="+$("#pxmax").val()+"&px_loyermax="+$("#pxmax").val(),!0)}(),"prestige"!=id3xContent.macro.E.PAGE.WAG_STYLE_RECHERCHE_DEFAULT&&$("#Mini_Moteur").submit(function(e){e.preventDefault(),$(".moteur-mobilefirst").removeClass("is-active"),$("body").removeClass("has-modal"),$("#Mini_Moteur").find("[name='annlistepg']").val(1),$("#Mini_Moteur").find(".message-suggest-liste,.close-liste").hide(),$("#idtypebien").val()&&$("#idtypebien-hidden").val(""),s()}),$("#trierRefine").change(function(e){s()}),$(".recherche-mobilefirst").on("click",".remove-filter",function(e){e.preventDefault();var t=$(this).data("qry");$("#Mini_Moteur").find("[name='"+t+"']").each(function(){$(this).val(""),"ci"==t&&$(".line-suggest-selected").remove()}),s()}),$(".ville-suggest-liste").on("click",".line-suggest-selected",function(e){e.preventDefault(),s()}),$("#recherche-listing").on("click",".pagination a, .pagination div",function(e){e.preventDefault();var t=$(this).html();"&lt;&lt;"==t?t=1:"&gt;&gt;"==t?t=maxpage:"&gt;"==t?t=parseInt($(".page-courante").html())+1:"&lt;"==t&&(t=parseInt($(".page-courante").html())-1),$("#Mini_Moteur").find("[name='annlistepg']").val(t),s()}),$("#Mini_Moteur, #recherche-listing").on("click",".bouton-raz",function(e){e.preventDefault(),r(),s()}),$("#idtt").change(function(){c("idtt","Mini_Biens","type_biens","idtypebien="+$("#idtypebien-hidden").val(),!0),c("idtt","Mini_Budget","budget_mobilefirst","pxmax="+$("#pxmax").val()+"&px_loyermax="+$("#pxmax").val(),!0)})});