var boutonOK="",messageOK="",contactFormInitiated=!1,ajaxDetailContact=null,formContactAgence=null,responseBox=null,submitButton=null,submitNormal=null;function dc_clear(t){var e=$(".clearable[name="+t+"]");e.removeClass("x onX").blur(),e.datepicker("hide"),e.datepicker("clearDates"),"start"===t&&dc_clear("end")}function dc_tog(t){return t?"addClass":"removeClass"}function dc_sendMailContact(){$.ajax({type:"POST",dataType:"json",url:"/detail,incl_contact_agence_email.htm",data:ajaxDetailContact,success:function(t){t.message.length?(responseBox.html(t.message),submitButton.button("reset")):(responseBox.html(messageOK),submitButton.html(boutonOK))},error:function(t,e,n){}})}function dc_sendMailToAgency(t){var e=$("#contact_ajax_SLAgence_X_V5");if(e.length){var n=e.serialize();$.ajax({type:"POST",dataType:"html",url:"/agence,contact.htm?idp="+t,data:n,success:function(t){window.location.href=document.getElementsByName("page_ok")[0].value},error:function(t,e,n){window.location.href=document.getElementsByName("page_err")[0].value}})}}function incl_detail_contact(p){if(""!=p.idp&&""!=p.typBtn&&""!=p.typBtnAct){var buttonMailToAgency=$("."+p.typBtn+"."+p.typBtnAct+".btn-large.btn-block");if(buttonMailToAgency.length){var onClickExpr="dc_sendMailToAgency('"+p.idp+"');";"1"==p.recaptchaGoogle&&(onClickExpr='e.preventDefault(); useGoogleRecaptcha({ final_steps: "'+onClickExpr+'" });'),onClickExpr='buttonMailToAgency.on("click", function(e) { '+onClickExpr+" });",eval(onClickExpr)}}formContactAgence=$("#form-contact-agence"),formContactAgence.length&&(formContactAgence.find("input[type=text]").change(function(){if(!contactFormInitiated){formContactAgence.find("input[name=type-message]:checked").attr("data-type");contactFormInitiated=!0}}),submitButton=$(".btn-send-contact"),submitButton.length&&(submitNormal=submitButton.html(),$(submitButton).on("click",function(){$('input[name="cnom"]').val(),$('input[name="from"]').val(),$('input[name="ctel"]').val();formContactAgence.find("input[name=type-message]:checked").attr("data-type")})),responseBox=$(".response"),formContactAgence.find("input[name=type-message]").change(function(){var t=$(this);$("fieldset").slideUp().hide(),$("fieldset."+t.attr("data-type")).slideDown().show(),responseBox.html(""),submitButton.button("reset")}),messageOK='<i class="pt10 text-center bigger icon-v5-checkmark"></i><span class="big">'+p.bienEnvoye+"</span>","1"==p.traitementMail&&(messageOK+="<br />"+p.traitonsDemande),boutonOK=p.envoiConfirme,formContactAgence.submit(function(t){t.preventDefault();var e=$(this);if(e.length){var n=e.serialize();if(n){var a=n.replace(",/g",",");if(a){var o=a.replace(/%0D%0A/g," ");if(o){var i=e.find("input[name=type-message]:checked").attr("data-message");i&&(o+="&content="+(i+="(annonce réf : "+p.nomAgenceDetail+"  "+p.urlVirtuelle+")  Cordialement"));var c=e.find("textarea[name=demande_autre]").val();if(c){var l=null,s=e.find("input.input-small[name=start]"),r=e.find("input.input-small[name=end]");s.length&&(l="Période location souhaitée : ",c+="\\n"+(l+=0<r.length?"du "+s.val()+" au "+r.val():"départ le "+s.val())),o+="&message="+c}ajaxDetailContact=o,submitButton.button("loading"),"1"!=p.recaptchaGoogle?dc_sendMailContact():(t.preventDefault(),useGoogleRecaptcha({final_steps:"dc_sendMailContact();"}))}}}}})),"4"==p.annIdtt&&($(".input-daterange").datepicker({language:"fr",toggleActive:!0,weekStart:1}),$(document).on("change",".clearable",function(){""===this.value&&$(this).hasClass("x")?dc_clear($(this).attr("name")):$(this)[dc_tog(this.value)]("x")}).on("mousemove",".x",function(t){$(this)[dc_tog(this.offsetWidth-18<t.clientX-this.getBoundingClientRect().left)]("onX")}).on("touchstart click",".onX",function(t){t.stopPropagation();var e=$(this);e[0].hideDatepicker=!0,dc_clear(e.attr("name")),setTimeout(function(){e[0].hideDatepicker=!1},200)}))}