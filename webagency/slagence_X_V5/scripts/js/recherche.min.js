function fixStar(e){var n=$("#annonce"+e);if(n.length>0){var t=n.find(".bouton-ajouter-selection-detail"),r=t.attr("data-title-ok");t.children().find("i").length>0&&(t.children().find(".plus").addClass("display-none"),t.children().find(".checkmark").removeClass("display-none").children("i").css("color","#51a351")),t.attr("data-original-title",r).tooltip("fixTitle").find("img").attr("src","/z/webagency/slagence_X_V5/images/widget/star_ok.png")}}function countSelection(e){$(".bouton-selection-annonces").children("span").html("<strong>"+e+"</strong>")}var countAnnonce=0,verif=3,count=0,regEmail=new RegExp("^[0-9a-z._-]+@{1}[0-9a-z.-]{2,}[.]{1}[a-z]{2,5}$","i");$(document).ready(function(){$(".photo-agence-annonces").each(function(){return $("html").hasClass("ie7")?!1:void $(this).hover(function(){$(this).find(".display-none").length>0&&($(this).children().first().hide(),$(this).children().last().show())},function(){$(this).find(".display-none").length>0&&($(this).children().first().show(),$(this).children().last().hide())})}),winW>600&&($("#recherche-listing").on("click",".bouton-video-360",function(){$(this).colorbox({iframe:!0,innerWidth:720,innerHeight:490,fastIframe:!1})}),$("#recherche-listing").on("click",".bouton-video-detail",function(){$(this).colorbox({iframe:!0,innerWidth:720,innerHeight:480,fastIframe:!1})})),$("#recherche-listing").on("click",".bouton-ajouter-selection-detail",function(){var e=$(this),n=e.attr("data-title-ok"),t=e.find(".plus"),r=$(this).attr("data-idpublication"),a=$(this).attr("data-idannonce");t.hasClass("display-none")?$.ajax({type:"GET",data:"idannonce="+a+"&idp="+r,dataType:"json",cache:!1,url:"/scripts,panier,selection_supprimer.htm",success:function(t){e.attr("data-original-title",n).tooltip("fixTitle").tooltip("show").find("img").attr("src","/z/webagency/slagence_X_V5/images/widget/star_ok.png"),e.children().find("i").length>0&&(e.children().children().find(".checkmark").addClass("display-none").children("i").css("color",""),e.children().children().find(".plus").removeClass("display-none")),countSelection(t.nbAnnonces)}}):$.ajax({type:"GET",dataType:"json",cache:!1,data:"idannonce="+a+"&idpublication="+r,url:"/scripts,panier,selection_ajouter.htm",success:function(t){e.attr("data-original-title",n).tooltip("fixTitle").tooltip("show").find("img").attr("src","/z/webagency/slagence_X_V5/images/widget/star_ok.png"),e.children().find("i").length>0&&(e.children().children().find(".plus").addClass("display-none"),e.children().children().find(".checkmark").removeClass("display-none").children("i").css("color","#51a351")),countSelection(t.nbAnnonces)}})});var e=$(this).find(".bouton-comparer-selection-detail").find("img").attr("src");$("#recherche-resultats-listing").on("click",".bouton-comparer-selection-detail",function(){var n=$(this);n.hasClass("clickCompared")?(n.find("img").attr("src",e),n.removeClass("clickCompared")):(n.find("img").attr("src","/z/webagency/slagence_X_V5/images/widget/checkmark_ok.png"),n.addClass("clickCompared"))}),$("#recherche-resultats-listing").on("click",".bouton-supprimer-selection-detail",function(){var e=$(this).attr("data-idannonce"),n=$(this).attr("data-idpublication");$.ajax({type:"GET",data:"idannonce="+e+"&idp="+n,dataType:"html",cache:!1,url:"/scripts,panier,selection_supprimer.htm",success:function(e){window.location.reload()},error:function(e,n){},complete:function(e,n){}})}),$(".bouton-comparer-selection").on("click",function(){var e=$("html").attr("lang"),n=$(this).attr("data-imprimer"),t="",r=0;if($(".clickCompared").each(function(){t+=$(this).attr("data-idannonce")+",",r++}),0==r)if($(".bouton-comparer-selection-detail").each(function(){$(this).find("img").attr("src","/z/webagency/slagence_X_V5/images/widget/checkmark_ok.png"),$(this).addClass("clickCompared"),t+=$(this).attr("data-idannonce")+","}),1==n){var a=window.open("recherche,incl_comparaison.htm?idannonces="+t+"&lang="+e,"Print","width=500,height=400");a.focus(),a.print()}else $(this).colorbox({width:"75%",height:"60%",iframe:!0,href:"recherche,incl_comparaison.htm?idannonces="+t+"&lang="+e+"&print="+n,close:"X",onLoad:function(){$("#colorbox").attr("style","outline:none")}});else if(1==n){var a=window.open("recherche,incl_comparaison.htm?idannonces="+t+"&lang="+e,"Print","width=500,height=400");a.focus(),a.print()}else $(this).colorbox({width:"75%",height:"60%",iframe:!0,href:"recherche,incl_comparaison.htm?idannonces="+t+"&lang="+e+"&print="+n})}),$("#form-tri").on("change","#trierAnnonce",function(){var e=$(this).val(),n=$("#form-tri").attr("action");n+="&tri="+e,window.location.href=n}),$(".bouton-vider-selection").on("click",function(e){e.preventDefault();$("#recherche-resultats-listing");$.ajax({type:"GET",cache:!1,url:"/scripts,panier,selection_vider.htm",success:function(e){window.location.reload(!0)}})}),$(".bouton-alerte-moteur").on("click",function(e){e.preventDefault();var n=$(this);n.button("loading"),$.ajax({type:"POST",data:$("#form-alerte-moteur").serialize(),dataType:"json",url:"/alerte,incl_creation.htm",beforeSend:function(){$(".message-erreur-alerte").html("")},success:function(e){e.message.length>0?($(".message-erreur-alerte").html(e.message),e.nom.length<=0?$("#nom-alerte").parent().addClass("error").removeClass("success"):$("#nom-alerte").parent().removeClass("error").addClass("success"),e.email.length<=0||0==regEmail.test(e.email)?$("#email-alerte").parent().addClass("error").removeClass("success"):$("#email-alerte").parent().removeClass("error").addClass("success")):e.idInscription.length>0&&($("#nom-alerte").parent().removeClass("error").removeClass("success"),$("#email-alerte").parent().removeClass("error").removeClass("success"),$(".message-erreur-alerte").html(inscriptionOK))},error:function(e,n,t){console.log(e,n,t)},complete:function(){n.button("reset"),$(".message-erreur-alerte").show("slow").delay(1500).hide("slow")}})}),$(".bouton-alerte-moteur2").on("click",function(e){e.preventDefault();var n=$(this);n.button("loading"),$.ajax({type:"POST",data:$("#form-alerte-moteur2").serialize(),dataType:"json",url:"/alerte,incl_creation.htm",beforeSend:function(){$(".message-erreur-alerte").html("")},success:function(e){e.message.length>0?($(".message-erreur-alerte").html(e.message),e.nom.length<=0?$("#nom-alerte").parent().addClass("error").removeClass("success"):$("#nom-alerte").parent().removeClass("error").addClass("success"),e.email.length<=0||0==regEmail.test(e.email)?$("#email-alerte").parent().addClass("error").removeClass("success"):$("#email-alerte").parent().removeClass("error").addClass("success")):e.idInscription.length>0&&($("#nom-alerte").parent().removeClass("error").removeClass("success"),$("#email-alerte").parent().removeClass("error").removeClass("success"),$(".message-erreur-alerte").html(inscriptionOK))},error:function(e,n,t){console.log(e,n,t)},complete:function(){n.button("reset"),$(".message-erreur-alerte").show("slow").delay(1500).hide("slow")}})}),$(".creer-alerte-email").on("click",function(e){e.preventDefault(),sliderBloc("#alerte-moteur")}),$(".bouton-search-ref-envoi").on("click",function(e){e.stopPropagation();var n=$("#refannonce").val();$("#refannonce").val(n),n.length<2?$(".erreur-saisie-ref").show():($(".erreur-saisie-ref").hide(),$("#moteur-reference").submit())})});