$(document).ready(function() {	$t = $('#moduleBerne');	// MGT UL	var $firstUL = $t.find('ul[id*=divModule]').first();	$firstUL.show();	var $secondUL = $t.find('ul[id*=divModule2]');	$secondUL.hide();	var $lastUL = $t.find('ul[id*=divModule3]');	$lastUL.hide();	// MGT LI	var $liFirst = $firstUL.find('li').first();	var $liSecond = $secondUL.find('li').first();	var $liLast = $lastUL.find('li').first();	// GET ID LI FOR PICTURE	var $idFirst = $liFirst.attr('id').split('bloc');	if($liSecond.attr('id')){		var $idSecond = $liSecond.attr('id').split('bloc');	}	if($liLast.length > 0) {		var $idLast = $liLast.attr('id').split('bloc');	}	// MGT PHOTO MODULE	var $firstModulePhoto = $t.find('ul[id*=photoModule]').first();	var $secondModulePhoto = $t.find('ul[id*=photoModule2]');	$firstModulePhoto.find('li').each(function() {		var $test = 'photoListe'+$idFirst[1];		if($(this).attr('id') == $test) {			$(this).show();			$(this).addClass('imageOn');		} else {			$(this).hide();			$(this).removeClass('imageOn');		}	});	$firstModulePhoto.show();	if($liLast.length > 0) {		var $lastModulePhoto = $t.find('ul[id*=photoModule]').last();		$lastModulePhoto.find('li').each(function() {			var $test = 'photoListe'+$idLast[1];			if($(this).attr('id') == $test) {				$(this).show();				$(this).addClass('imageOn');			} else {				$(this).hide();				$(this).removeClass('imageOn');			}		});		$lastModulePhoto.hide();		$secondModulePhoto.hide();	}	// MGT SPAN	var $firstSpan = $t.find('.onglet1');	var $secondSpan = $t.find('.onglet2');	var $lastSpan = $t.find('.onglet3');	// CALCUL MODULE FOR OVERFLOW	var $module = $t.find('.moduleDiv');	$module.height($liFirst.height() * 4)	// MGT SECTION	$firstSpan.css('cursor','pointer');	$firstSpan.click(function() {		// FIRST		$firstUL.show();		$firstModulePhoto.show();		$firstModulePhoto.find('li').first().show();		$firstUL.addClass('actifUL');		$(this).addClass('actifSpan');		// second + LAST 		$secondUL.hide();		$lastUL.hide();		$secondModulePhoto.hide();		$lastModulePhoto.hide();		$secondUL.removeClass('actifUL');		$lastUL.removeClass('actifUL');		$secondSpan.removeClass('actifSpan');		$secondSpan.addClass('noActifSpan');		$lastSpan.removeClass('actifSpan');		$lastSpan.addClass('noActifSpan');	});	$secondSpan.css('cursor','pointer');	$secondSpan.click(function() {		// FIRST + last		$firstUL.hide();		$firstModulePhoto.hide();		$lastModulePhoto.hide();		$firstUL.removeClass('actifUL');		$firstSpan.removeClass('actifSpan');		$firstSpan.addClass('noActifSpan');		$lastUL.hide();		$lastUL.removeClass('actifUL');		$lastSpan.removeClass('actifSpan');		$lastSpan.addClass('noActifSpan');		// second		$secondUL.show();		$secondModulePhoto.show();		$secondModulePhoto.find('li').hide();		$secondModulePhoto.find('li').first().show();		$secondUL.addClass('actifUL');		$(this).addClass('actifSpan');	});	$lastSpan.css('cursor','pointer');	$lastSpan.click(function() {		// FIRST + second		$firstUL.hide();		$firstModulePhoto.hide();		$firstUL.removeClass('actifUL');		$firstSpan.removeClass('actifSpan');		$firstSpan.addClass('noActifSpan');		$secondUL.hide();		$secondModulePhoto.hide();		$secondUL.removeClass('actifUL');		$secondSpan.removeClass('actifSpan');		$secondSpan.addClass('noActifSpan');		// LAST		$lastUL.show();		$lastModulePhoto.show();		$lastModulePhoto.find('li').first().show();		$lastUL.addClass('actifUL');		$(this).addClass('actifSpan');		//$lastSpan.addClass('noActifSpan');	});	// MGT LINE	$t.find('.ligneModuleBerne').each(function() {		var $tLigne = $(this);		$tLigne.css('cursor','pointer');		// FIXING FIRST LOADING		if(($tLigne.attr('id') == $liFirst.attr('id')) || ($tLigne.attr('id') == $liLast.attr('id'))) {			$(this).find('.pucePlus').show();			$(this).addClass('rollOverLigneModule');		} else {			$(this).find('.pucePlus').hide();			$(this).removeClass('rollOverLigneModule');		}		// MOUSEOVER		$tLigne.mouseover(function() {				var $modulePicture = $('.rightModule');				// FIXING OLD								var $old = $(this).parent().find('.rollOverLigneModule');				$old.find('.pucePlus').hide();				$old.removeClass('rollOverLigneModule');				// FIXING OLD PICTURE				var $old_picture = $modulePicture.find('.imageOn');				$old_picture.hide();				$old_picture.removeClass('imageOn');				// FIXING NEW				$(this).find('.pucePlus').show();				$(this).addClass('rollOverLigneModule');				// FIXING NEW PICTURE				var $idLigne = $(this).attr('id').split('bloc');				var $moduleListe = $(this).parent().attr('id').split('divModule');				var $containerPhoto = '#photoModule'+$moduleListe[1]				var $new_pic = $modulePicture.find($containerPhoto).find('#photoListe'+$idLigne[1]);				$new_pic.addClass('imageOn');				$new_pic.show();		});	});	var bouton = 0;	// MGT UP/DOWN 	$('.flecheUp').css('cursor','pointer');	$('.flecheUp').click(function() {		if(bouton == 0) {			bouton = 1;			$ulRunning = $t.find('.actifUL');			var $heightGlobal = $ulRunning.find('li').height() * $ulRunning.find('li').length;			var $height = $ulRunning.find('li').height() * 4;			var $max = $heightGlobal * -1;			var $currentY = parseInt($ulRunning.css('top'));			var $calcul = $currentY-$height;			if($calcul == $max || ($calcul * -1) >= $heightGlobal) {				$calcul = 0;				$ulRunning.css('top',$calcul+'px');				fixPosition($ulRunning,$calcul);				bouton = 0;			} else {				$ulRunning.animate({top:$calcul+'px'},250, function() {bouton = 0;fixPosition($ulRunning,$calcul)});			}		}	});	$('.flecheDown').css('cursor','pointer');	$('.flecheDown').click(function() {		if(bouton == 0) {			bouton = 1;			$ulRunning = $t.find('.actifUL');			var $heightGlobal = $ulRunning.find('li').height() * $ulRunning.find('li').length;			var $height = $ulRunning.find('li').height() * 4;			var $max = $heightGlobal * -1;			var $currentY = parseInt($ulRunning.css('top'));			var $calcul = $currentY+$height;			if(($calcul > $currentY && $currentY == 0)) {				$calcul = $max + $height;				$ulRunning.css('top',$calcul+'px');				fixPosition($ulRunning,$calcul);				bouton = 0;			} else {				/*console.log("ok");				console.log($currentY);				console.log($max);				console.log($heightGlobal);				console.log($height);				console.log($calcul);*/				var $fix_pos = $height + $currentY;				if($fix_pos > 0) {					$calcul = 0;				}				$ulRunning.animate({top:$calcul+'px'},250, function() {bouton = 0;fixPosition($ulRunning,$calcul)});			}		}	});});function fixPosition($t,$c) {	$t.find('li').each(function() {		var $position = $(this).position();		if($position.top == ($c * -1)) {			// FIX LINE			var $old = $t.find('.rollOverLigneModule');			$old.find('.pucePlus').hide();			$old.removeClass('rollOverLigneModule');			$(this).addClass('rollOverLigneModule');			$(this).find('.pucePlus').show();			// FIX PICTURE			var $id_module = $t.attr('id').split('divModule');			var $module_photo = $('#photoModule'+$id_module[1]);			var $new_id = $(this).attr('id').split('bloc');			var $photo = $module_photo.find('.imageOn');			$photo.hide();			$photo.removeClass('imageOn');			var $new_pic = $module_photo.find('#photoListe'+$new_id[1]);			$new_pic.addClass('imageOn');			$new_pic.show();		}	});}