$$SET:PAGE:IDT=PETITMOTEUR$$
<script language="javascript">
<!--
function openCodes_Postaux() {
	window.open('/cp_frame.htm?lang=$$LANGUE$$' , 'cdp', ',height=330,width=360,scrollbars=yes, resizable=no, toolbar=no, status=no, menubar=no');
}
function MM_findObj(n, d) { //Fonction permettant de trouver un élément HTML dans la page
	var p, i, x;
	if(!d) {
		d=document;
	}
	if ( (p = n.indexOf("?") ) > 0 && parent.frames.length) {
		d = parent.frames[n.substring(p + 1)].document;
		n = n.substring(0, p);
	}
	if( !(x = d[n]) && d.all) {
		x = d.all[n];
	}
	for (i = 0; !x && i < d.forms.length; i++) {
		x = d.forms[i][n];
	}
	for(i = 0; !x && d.layers && i < d.layers.length; i++) {
		x = MM_findObj(n, d.layers[i].document);
	}
	if( !x && document.getElementById ) {
		x = document.getElementById(n);
	}
	return x;
}
function checkType() { //vérifie quel type de bien est sélectionné
	var typedebien = MM_findObj("idtypebien");
	if (typedebien) {
		for (i = 0; i <= typedebien.length; i++) {
			if (typedebien.options[i]) {
				if (typedebien.options[i].selected) {
					getSousType(typedebien.options[i].value);
				}
			}
		}
	}
}

function changeType() {

var id = document.annonces.idtypebien.options.length;
id--;

if((document.annonces.idtt["1"].selected==true)||(document.annonces.idtt["2"].selected==true)||(document.annonces.idtt["3"].selected==true)){
document.annonces.idtypebien.options[id].selected = true;}
else{document.annonces.idtypebien.options[0].selected = true;}

}

function getSousType(type) { //affiche les sous types de bien pour un type de bien sélectionné
	var verif = false; //variable de controle, true si un changement a été fait dans l'affichage des tr
	var bien; //variable qui va contenir les tr de type "sous type de bien"
	// 15 dans la boucle ci-dessous correspond au nombre total de types de bien (15)
	for (i = 0; i <= 15; i++) { //boucle sur les types de biens pour afficher / enlever les tr "sous types de bien" correspondant
		bien = MM_findObj("typebien" + i);
		if (bien) { //si le tr correspondant existe (ie: si il y a des sous types de biens rattachés au "type")
			if (bien.style) {
				if (i == type) {
						bien.style.display = ""; //affiche le tr correspondant
						verif = true; //validation du controle
				}
				if (!verif) {
						bien.style.display = "none";
				}
			}
		}
		verif = false;
	}
}
-->
</script>
<!-- $$FORM:IDTT$$ -->
<form method="get" action="$$IF:REP:1$$/$$REP:1$$$$END$$/prerecherche.htm" name="annonces" id="annonces">
$$IF!:1:PAGE:PROXIMITE$$<input type="hidden" name="cp" value="" />$$END$$
<input type="hidden" name="lang" value="$$LANGUE$$" />
<table cellpadding="1" cellspacing="0" class="tabFond1Mini">
<tr>
	<td>
	<table cellpadding="1" cellspacing="0" class="tabFond1Mini">
	<!-- TYPE DE TRANSACTION -->
	<tr>
		<td class="tabTitremini">$$LG:TYPEDETRANSACTION$$</td>
		<td class="tabFond2mini">
			<!-- Gymnastique nécessaire pour tenir compte du A:PAGE:IDTT1=0 => n'affiche pas l'id TT1, et l'affiche si A:PAGE:IDTT1=1 ou si rien (par défaut) -->
		$$B:IMMOBW:AGENCETRANSACTIONS:ALIAS:BIENSAG:REP:2:QRY:LANG$$
		$$BIF:BIENSAG$$
 		<select class="Form" name="idtt" id="idtt" size="1" onchange="javascript:changeType();">
		$$DO:0:99$$
		<option value="$$BIENSAG:IDTYPETRANSACTION$$"$$IF(:BIENSAG:IDTYPETRANSACTION$$selected="selected"$$END$$>$$BIENSAG:DESCRIPTIONLGP pcase$$</option>
		$$LOOP$$
		</select>
	  $$BFIN$$
		</td>
	</tr>
	<!-- TYPE DE BIEN -->
	$$IF!:0:PAGE:TYPEDEBIEN$$
		$$B:IMMOBW:TYPESBIENS:ALL:QRY:LANG$$
		$$BIF:IMMOBW:TYPESBIENS:ALL$$
		$$IF=:1:PAGE:IDTB1$$$$A:PAGE:AFFICHETYPESBIEN=1,9,$$$$END$$
		$$IF=:1:PAGE:IDTB2$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@2,$$$$END$$
		$$IF=:1:PAGE:IDTB3$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@4,$$$$END$$
		$$IF=:1:PAGE:IDTB4$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@5,6,$$$$END$$
		$$IF=:1:PAGE:IDTB5$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@8,$$$$END$$
		$$IF=:1:PAGE:IDTB7$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@3,$$$$END$$
		$$IF=:1:PAGE:IDTB8$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@7,$$$$END$$
		$$IF=:1:PAGE:IDTB9$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@11,$$$$END$$
		$$IF=:1:PAGE:IDTB10$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@12,$$$$END$$
		$$IF=:1:PAGE:IDTB11$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@13,$$$$END$$
		$$IF=:1:PAGE:IDTB12$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@14,$$$$END$$
		$$IF=:1:PAGE:IDTB6$$$$A:PAGE:AFFICHETYPESBIEN=@@PAGE:AFFICHETYPESBIEN@@10$$$$END$$
		<tr>
			<td class="tabTitremini">$$LG:TYPEDEBIEN$$</td>
			<td class="tabFond2mini">
			<select class="Form" name="idtypebien" id="idtypebien" size="1" onchange="javascript:checkType();">
				<option value="$$PAGE:AFFICHETYPESBIEN$$"> -- $$LG:TOUS$$ -- </option>
				$$DO$$
					$$IF(:PAGE_AFFICHETYPESBIEN:IMMOBW:TYPESBIENS:ALL:IDTYPEBIEN$$
						<option value="$$IMMOBW:TYPESBIENS:ALL:IDTYPEBIEN$$"$$IF(:FORM_IDTYPEBIEN:IMMOBW:TYPESBIENS:ALL:IDTYPEBIEN$$selected="selected"$$END$$>$$IMMOBW:TYPESBIENS:ALL:DEF_LIBELLE$$</option>
					$$END$$
				$$LOOP$$
				<option value="t" name="aucun" id="aucun"> -- -- </option>
			</select>
			</td>
		</tr>
		$$BFIN$$
	$$END$$
	<!-- SOUS TYPE DE BIEN -->
	$$IF:PAGE:SOUSTYPEDEBIEN$$
	$$B:IMMOBW:SOUSTYPESBIEN$$
	$$BIF:IMMOBW:SOUSTYPESBIEN$$
	$$DO:1:999$$
		$$IF0:CHECKTYPEBIEN$$
			$$A:CHECKTYPEBIEN=@@IMMOBW:SOUSTYPESBIEN:IDTYPEBIEN@@$$
			<tr id="typebien$$CHECKTYPEBIEN$$" style="display:none;">
				<td class="tabTitremini">$$LG:MINISOUSTYPEDEBIEN$$</td>
				<td class="tabFond2mini">
				<select class="Form" name="idsoustypebien" size="1">
					<option value="$$IF!:ALL:PAGE:SOUSTYPEDEBIEN$$$$PAGE:SOUSTYPEDEBIEN$$$$END$$"> -- $$LG:TOUS$$ -- </option>
		$$END$$
		$$IF!:CHECKTYPEBIEN:IMMOBW:SOUSTYPESBIEN:IDTYPEBIEN$$
			$$A:CHECKTYPEBIEN=@@IMMOBW:SOUSTYPESBIEN:IDTYPEBIEN@@$$
				</select>
				</td>
			</tr>
			<tr id="typebien$$CHECKTYPEBIEN$$" style="display:none;">
				<td class="tabTitremini">$$LG:MINISOUSTYPEDEBIEN$$</td>
				<td class="tabFond2mini">
				<select class="Form" name="idsoustypebien" size="1">
					<option value="$$IF!:ALL:PAGE:SOUSTYPEDEBIEN$$$$PAGE:SOUSTYPEDEBIEN$$$$END$$"> -- $$LG:TOUS$$ -- </option>
		$$END$$
		$$IF=:CHECKTYPEBIEN:IMMOBW:SOUSTYPESBIEN:IDTYPEBIEN$$
			$$IF=:ALL:PAGE:SOUSTYPEDEBIEN$$
					<option value="$$IMMOBW:SOUSTYPESBIEN:IDSOUSTYPEBIEN$$">$$IMMOBW:SOUSTYPESBIEN:DEF_LIBELLE htmlencode$$</option>
			$$END$$
			$$IF!:ALL:PAGE:SOUSTYPEDEBIEN$$
				$$IF(:PAGE_SOUSTYPEDEBIEN:IMMOBW:SOUSTYPESBIEN:IDSOUSTYPEBIEN$$
					<option value="$$IMMOBW:SOUSTYPESBIEN:IDSOUSTYPEBIEN$$">$$IMMOBW:SOUSTYPESBIEN:DEF_LIBELLE htmlencode$$</option>
				$$END$$
			$$END$$
		$$END$$
	$$LOOP$$
				</select>
				</td>
			</tr>
	$$BFIN$$
	$$END$$
	<!-- Nombre de pièces -->
	$$IF=:1:PAGE:PIECES$$
	<tr>
		<td class="tabTitremini">$$LG:MININBRPIECES$$</td>
		<td valign="top" class="tabFond2mini">
		<select class="Form" name="nb_pieces" size="1">
			<option value=""> -- -- </option>
			<option value="1"$$IF=:1:FORM:NB_PIECES$$ selected="selected"$$END$$>1</option>
			<option value="2"$$IF=:2:FORM:NB_PIECES$$ selected="selected"$$END$$>2</option>
			<option value="3"$$IF=:3:FORM:NB_PIECES$$ selected="selected"$$END$$>3</option>
			<option value="4"$$IF=:4:FORM:NB_PIECES$$ selected="selected"$$END$$>4</option>
			<option value="4+"$$IF=:4+:FORM:NB_PIECES$$ selected="selected"$$END$$>5 $$LG:ETPLUS$$</option>
		</select>
		</td>
	</tr>
	$$END$$
	<!-- RECHERCHE PAR REFERENCE -->
	$$IF=:1:PAGE:REF$$
	<tr>
		<td class="tabTitremini">$$LG:MINIRECHREF$$</td>
		<td><input class="Form" type="text" name="refannonce" size="15" id="ref_ann" value="$$FORM:REF$$" /></td>
	</tr>
	$$END$$
	<!-- Budget -->
	$$IF=:1:PAGE:BUDGET$$
	<tr>
		<td class="tabTitremini">$$LG:BUDGET$$</td>
		<td valign="top" class="tabFond2mini">$$LG:MINI$$&nbsp;:&nbsp;<input class="Form" type="text" name="pxmin" size="4" value="$$FORM:PXMIN$$" />
		&nbsp;$$LG:MAXI$$&nbsp;:&nbsp;<input class="Form" type="text" name="pxmax" size="4" value="$$FORM:PXMAX$$" />
		<input type="hidden" name="euro" value="1" />&nbsp;&euro;
		</td>
	</tr>
	$$END$$
	<!-- surface -->
	$$IF=:1:PAGE:SURFACE$$
	<tr>
		<td class="tabTitremini">$$LG:SURFACE$$</td>
		<td valign="top" class="tabFond2mini">$$LG:MINI$$&nbsp;:&nbsp;<input class="Form" type="text" name="surfacemin" size="4" value="$$FORM:SURFACEMIN$$" />
		&nbsp;$$LG:MAXI$$&nbsp;:&nbsp;<input class="Form" type="text" name="surfacemax" size="4" value="$$FORM:SURFACEMAX$$" /> m&sup2;</td>
	</tr>
	$$END$$
	<!-- Proximité -->
	$$IF=:1:PAGE:PROXIMITE$$
	<tr>
		<td class="tabTitremini" valign="top">$$LG:MINIVILLES$$</td>
		<td class="tabFond2mini">
		<input class="Form" type="text" name="cp" size="5" maxlength="50" />&nbsp;
		<input class="Form" type="text" name="cp" size="5" maxlength="50" />&nbsp;
		<input class="Form" type="text" name="cp" size="5" maxlength="50" />&nbsp;<br>
		(<i><a href="javascript:openCodes_Postaux();" class="minilien">$$LG:MINIRETROUVER$$</a></i>)
		</td>
	</tr>
	$$END$$
	<!-- Liste des Villes en menu déroulant -->
	$$IF=:1:PAGE:LISTEVILLES$$
	$$B:IMMOBW:VILLESANNONCES:::2$$
	$$BIF:IMMOBW:VILLESANNONCES:$$
	<tr>
		<td class="tabTitremini"><b>$$LG:MINICHOIXVILLES$$</b></td>
		<td class="tabFond2mini">
		<select class="Form" name="ci" size="1">
			<option value=""> -- -- </option>
			$$DO:1:120$$
			<option value="$$IMMOBW:VILLESANNONCES::CODEINSEE$$">$$IMMOBW:VILLESANNONCES::VILLEAFF$$</option>
			$$LOOP$$
		</select>
		</td>
	</tr>
	$$BFIN$$
	$$END$$
	<tr>
		<td align="center" colspan="2" class="tabFond2mini"><input type="image" src="img/minienvoyer_$$LANGUE$$.gif" border="0" /></td>
	</tr>
	</table>
	</td>
</tr>
</table>
<script language="javascript"> checkType(); </script>
</form>